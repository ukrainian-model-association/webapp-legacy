function eli18n(b){this.textdomain=function(a){return this.messages[a]?this._domain=a:this._domain};b&&b.messages&&this.load(b.messages);b&&b.textdomain&&this.textdomain(b.textdomain)}eli18n.prototype=new function(){this.messages={};this._domain="";this.load=function(k){if(typeof(k)=="object"){for(var j in k){var g=k[j];if(typeof(g)=="object"){if(!this.messages[j]){this.messages[j]={}}for(var h in g){if(typeof(g[h])=="string"){this.messages[j][h]=g[h]}}}}}return this};this.translate=function(c,f){var f=f&&this.messages[f]?f:this._domain;return this.messages[f]&&this.messages[f][c]?this.messages[f][c]:c};this.format=function(j,g,k){j=this.translate(j,k);if(typeof(g)=="object"){for(var h in g){j=j.replace("%"+h,this.translate(g[h],k))}}return j}};function elDialogForm(h){var g=this;var f={"class":"el-dialogform",submit:function(b,a){a.close()},form:{action:window.location.href,method:"post"},ajaxForm:null,validate:null,spinner:"Loading",tabs:{active:0,selected:0},tabPrefix:"el-df-tab-",dialog:{title:"dialog",autoOpen:false,modal:true,resizable:false,closeOnEscape:true,buttons:{Cancel:function(){g.close()},Ok:function(){g.form.trigger("submit")}}}};this.opts=jQuery.extend(true,{},f,h);this.opts.dialog.close=function(){g.close()};if(this.opts.rtl){this.opts["class"]+=" el-dialogform-rtl"}if(h&&h.dialog&&h.dialog.buttons&&typeof(h.dialog.buttons)=="object"){this.opts.dialog.buttons=h.dialog.buttons}this.ul=null;this.tabs={};this._table=null;this.dialog=jQuery("<div />").addClass(this.opts["class"]).dialog(this.opts.dialog);this.message=jQuery('<div class="el-dialogform-message rounded-5" />').hide().appendTo(this.dialog);this.error=jQuery('<div class="el-dialogform-error rounded-5" />').hide().appendTo(this.dialog);this.spinner=jQuery('<div class="spinner" />').hide().appendTo(this.dialog);this.content=jQuery('<div class="el-dialogform-content" />').appendTo(this.dialog);this.form=jQuery("<form />").attr(this.opts.form).appendTo(this.content);if(this.opts.submit){this.form.bind("submit",function(a){g.opts.submit(a,g)})}if(this.opts.ajaxForm&&jQuery.fn.ajaxForm){this.form.ajaxForm(this.opts.ajaxForm)}if(this.opts.validate){this.form.validate(this.opts.validate)}this.option=function(b,a){return this.dialog.dialog("option",b,a)};this.showError=function(b,a){this.hideMessage();this.hideSpinner();this.error.html(b).show();a&&this.content.hide();return this};this.hideError=function(){this.error.text("").hide();this.content.show();return this};this.showSpinner=function(a){this.error.hide();this.message.hide();this.content.hide();this.spinner.text(a||this.opts.spinner).show();this.option("buttons",{});return this};this.hideSpinner=function(){this.content.show();this.spinner.hide();return this};this.showMessage=function(b,a){this.hideError();this.hideSpinner();this.message.html(b||"").show();a&&this.content.hide();return this};this.hideMessage=function(){this.message.hide();this.content.show();return this};this.tab=function(a,b){a=this.opts.tabPrefix+a;if(!this.ul){this.ul=jQuery("<ul />").prependTo(this.form)}jQuery("<li />").append(jQuery("<a />").attr("href","#"+a).html(b)).appendTo(this.ul);this.tabs[a]={tab:jQuery("<div />").attr("id",a).addClass("tab").appendTo(this.form),table:null};return this};this.table=function(a){a=a&&a.indexOf(this.opts.tabPrefix)==-1?this.opts.tabPrefix+a:a;if(a&&this.tabs&&this.tabs[a]){this.tabs[a].table=jQuery("<table />").appendTo(this.tabs[a].tab)}else{this._table=jQuery("<table />").appendTo(this.form)}return this};this.append=function(b,a,o){a=a?"el-df-tab-"+a:"";if(!b){return this}if(a&&this.tabs[a]){if(o){!this.tabs[a].table&&this.table(a);var c=jQuery("<tr />").appendTo(this.tabs[a].table);if(!jQuery.isArray(b)){c.append(jQuery("<td />").append(b))}else{for(var p=0;p<b.length;p++){c.append(jQuery("<td />").append(b[p]))}}}else{if(!jQuery.isArray(b)){this.tabs[a].tab.append(b)}else{for(var p=0;p<b.length;p++){this.tabs[a].tab.append(b[p])}}}}else{if(!o){if(!jQuery.isArray(b)){this.form.append(b)}else{for(var p=0;p<b.length;p++){this.form.append(b[p])}}}else{if(!this._table){this.table()}var c=jQuery("<tr />").appendTo(this._table);if(!jQuery.isArray(b)){c.append(jQuery("<td />").append(b))}else{for(var p=0;p<b.length;p++){c.append(jQuery("<td />").append(b[p]))}}}}return this};this.separator=function(a){a="el-df-tab-"+a;if(this.tabs&&this.tabs[a]){this.tabs[a].tab.append(jQuery("<div />").addClass("separator"));this.tabs[a].table&&this.table(a)}else{this.form.append(jQuery("<div />").addClass("separator"))}return this};this.open=function(){var a=this;this.ul&&this.form.tabs(this.opts.tabs);setTimeout(function(){a.dialog.find(":text").keydown(function(b){if(b.keyCode==13){b.preventDefault();a.form.submit()}}).filter(":first")[0].focus()},200);this.dialog.dialog("open");return this};this.close=function(){if(typeof(this.opts.close)=="function"){this.opts.close()}this.dialog.dialog("destroy")}}(function(b){b.fn.elColorPicker=function(j){var a=this;var o=b.extend({},b.fn.elColorPicker.defaults,j);this.hidden=b('<input type="hidden" />').attr("name",o.name).val(o.color||"").appendTo(this);this.palette=null;this.preview=null;this.input=null;function p(c){a.val(c);o.change&&o.change(a.val());a.palette.slideUp()}function k(){a.palette=b("<div />").addClass(o.paletteClass+" rounded-3");for(var c=0;c<o.colors.length;c++){b("<div />").addClass("color").css("background-color",o.colors[c]).attr({title:o.colors[c],unselectable:"on"}).appendTo(a.palette).mouseenter(function(){var f=b(this).attr("title");a.input.val(f);a.preview.css("background-color",f)}).click(function(f){f.stopPropagation();p(b(this).attr("title"))})}a.input=b('<input type="text" />').addClass("rounded-3").attr("size",8).click(function(f){f.stopPropagation();b(this).focus()}).keydown(function(g){if(g.ctrlKey||g.metaKey){return true}var h=g.keyCode;if(h==27){return a.mouseleave()}if(h!=8&&h!=13&&h!=46&&h!=37&&h!=39&&(h<48||h>57)&&(h<65||h>70)){return false}var f=b(this).val();if(f.length==7||f.length==0){if(h==13){g.stopPropagation();g.preventDefault();p(f);a.palette.slideUp()}if(g.keyCode!=8&&g.keyCode!=46&&h!=37&&h!=39){return false}}}).keyup(function(f){var g=b(this).val();g.length==7&&/^#[0-9abcdef]{6}$/i.test(g)&&a.val(g)});a.preview=b("<div />").addClass("preview rounded-3").click(function(f){f.stopPropagation();p(a.input.val())});a.palette.append(b("<div />").addClass("clearfix")).append(b("<div />").addClass("panel").append(a.input).append(a.preview));if(o.palettePosition=="outer"){a.palette.hide().appendTo(a.parents("body").eq(0)).mouseleave(function(){if(!a.palette.is(":animated")){b(this).slideUp();a.val(a.val())}});a.mouseleave(function(f){if(f.relatedTarget!=a.palette.get(0)){if(!a.palette.is(":animated")){a.palette.slideUp();a.val(a.val())}}})}else{a.append(a.palette.hide()).mouseleave(function(f){a.palette.slideUp();a.val(a.val())})}a.val(a.val())}this.empty().addClass(o["class"]+" rounded-3").css({position:"relative","background-color":o.color||""}).click(function(h){if(!a.hasClass("disabled")){!a.palette&&k();if(o.palettePosition=="outer"&&a.palette.css("display")=="none"){var g=b(this).offset();var c=a.palette.width();var f=a.parents("body").width()-g.left>=c?g.left:g.left+b(this).outerWidth()-c;a.palette.css({left:f+"px",top:g.top+b(this).height()+1+"px"})}a.palette.slideToggle()}});this.val=function(c){if(!c&&c!==""){return this.hidden.val()}else{this.hidden.val(c);if(o.update){o.update(this.hidden.val())}else{this.css("background-color",c)}if(a.palette){a.preview.css("background-color",c);a.input.val(c)}}return this};return this};b.fn.elColorPicker.defaults={"class":"el-colorpicker",paletteClass:"el-palette",palettePosition:"inner",name:"color",color:"",update:null,change:function(a){},colors:["#ffffff","#cccccc","#999999","#666666","#333333","#000000","#ffcccc","#cc9999","#996666","#663333","#330000","#ff9999","#cc6666","#cc3333","#993333","#660000","#ff6666","#ff3333","#ff0000","#cc0000","#990000","#ff9966","#ff6633","#ff3300","#cc3300","#993300","#ffcc99","#cc9966","#cc6633","#996633","#663300","#ff9933","#ff6600","#ff9900","#cc6600","#cc9933","#ffcc66","#ffcc33","#ffcc00","#cc9900","#996600","#ffffcc","#cccc99","#999966","#666633","#333300","#ffff99","#cccc66","#cccc33","#999933","#666600","#ffff66","#ffff33","#ffff00","#cccc00","#999900","#ccff66","#ccff33","#ccff00","#99cc00","#669900","#ccff99","#99cc66","#99cc33","#669933","#336600","#99ff33","#99ff00","#66ff00","#66cc00","#66cc33","#99ff66","#66ff33","#33ff00","#33cc00","#339900","#ccffcc","#99cc99","#669966","#336633","#003300","#99ff99","#66cc66","#33cc33","#339933","#006600","#66ff66","#33ff33","#00ff00","#00cc00","#009900","#66ff99","#33ff66","#00ff33","#00cc33","#009933","#99ffcc","#66cc99","#33cc66","#339966","#006633","#33ff99","#00ff66","#00ff99","#00cc66","#33cc99","#66ffcc","#33ffcc","#00ffcc","#00cc99","#009966","#ccffff","#99cccc","#669999","#336666","#003333","#99ffff","#66cccc","#33cccc","#339999","#006666","#66cccc","#33ffff","#00ffff","#00cccc","#009999","#66ccff","#33ccff","#00ccff","#0099cc","#006699","#99ccff","#6699cc","#3399cc","#336699","#003366","#3399ff","#0099ff","#0066ff","#066ccc","#3366cc","#6699ff","#3366ff","#0033ff","#0033cc","#003399","#ccccff","#9999cc","#666699","#333366","#000033","#9999ff","#6666cc","#3333cc","#333399","#000066","#6666ff","#3333ff","#0000ff","#0000cc","#009999","#9966ff","#6633ff","#3300ff","#3300cc","#330099","#cc99ff","#9966cc","#6633cc","#663399","#330066","#9933ff","#6600ff","#9900ff","#6600cc","#9933cc","#cc66ff","#cc33ff","#cc00ff","#9900cc","#660099","#ffccff","#cc99cc","#996699","#663366","#330033","#ff99ff","#cc66cc","#cc33cc","#993399","#660066","#ff66ff","#ff33ff","#ff00ff","#cc00cc","#990099","#ff66cc","#ff33cc","#ff00cc","#cc0099","#990066","#ff99cc","#cc6699","#cc3399","#993366","#660033","#ff3399","#ff0099","#ff0066","#cc0066","#cc3366","#ff6699","#ff3366","#ff0033","#cc0033","#990033"]}})(jQuery);(function(b){b.fn.elBorderSelect=function(u){var r=this;var a=this.eq(0);var z=b.extend({},b.fn.elBorderSelect.defaults,u);var w=b('<input type="text" />').attr({name:z.name+"[width]",size:3}).css("text-align","right").change(function(){r.change()});var t=b("<div />").css("position","relative").elColorPicker({"class":"el-colorpicker ui-icon ui-icon-pencil",name:z.name+"[color]",palettePosition:"outer",change:function(){r.change()}});var x=b("<div />").elSelect({tpl:'<div style="border-bottom:4px %val #000;width:100%;margin:7px 0"> </div>',tpls:{"":"%label"},maxHeight:z.styleHeight||null,select:function(){r.change()},src:{"":"none",solid:"solid",dashed:"dashed",dotted:"dotted","double":"double",groove:"groove",ridge:"ridge",inset:"inset",outset:"outset"}});a.empty().addClass(z["class"]).attr("name",z.name||"").append(b("<table />").attr("cellspacing",0).append(b("<tr />").append(b("<td />").append(w).append(" px")).append(b("<td />").append(x)).append(b("<td />").append(t))));function v(c){function f(h){hexDigits=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];return !h?"00":hexDigits[(h-h%16)/16]+hexDigits[h%16]}var g=(c||"").match(/\(([0-9]{1,3}),\s*([0-9]{1,3}),\s*([0-9]{1,3})\)/);return g?"#"+f(g[1])+f(g[2])+f(g[3]):""}function o(f){if(!f){return f}var g=f.match(/([0-9]+\.?[0-9]*)\s*(px|pt|em|%)/);if(g){f=g[1];unit=g[2]}if(f[0]=="."){f="0"+f}f=parseFloat(f);if(isNaN(f)){return""}var c=parseInt(b(document.body).css("font-size"))||16;switch(unit){case"em":return parseInt(f*c);case"pt":return parseInt(f*c/12);case"%":return parseInt(f*c/100)}return f}this.change=function(){z.change&&z.change(this.val())};this.val=function(f){var g,c,k,h,j;if(!f&&f!==""){g=parseInt(w.val());g=!isNaN(g)?g+"px":"";c=x.val();k=t.val();return{width:g,style:c,color:k,css:b.trim(g+" "+c+" "+k)}}else{h="";if(f.nodeName||f.css){if(!f.css){f=b(f)}h=f.css("border");if((h=f.css("border"))){g=c=k=h}else{g=f.css("border-width");c=f.css("border-style");k=f.css("border-color")}}else{g=f.width||"";c=f.style||"";k=f.color||""}w.val(o(g));j=c?c.match(/(solid|dashed|dotted|double|groove|ridge|inset|outset)/i):"";x.val(j?j[1]:"");t.val(k.indexOf("#")===0?k:v(k));return this}};this.val(z.value);return this};b.fn.elBorderSelect.defaults={name:"el-borderselect","class":"el-borderselect",value:{},change:null}})(jQuery);(function(b){b.fn.elPaddingInput=function(k){var p=this;var o=b.extend({},b.fn.elPaddingInput.defaults,{name:this.attr("name")},k);this.regexps={main:new RegExp(o.type=="padding"?'paddings*:s*([^;"]+)':'margins*:s*([^;"]+)',"im"),left:new RegExp(o.type=="padding"?'padding-lefts*:s*([^;"]+)':'margin-lefts*:s*([^;"]+)',"im"),top:new RegExp(o.type=="padding"?'padding-tops*:s*([^;"]+)':'margin-tops*:s*([^;"]+)',"im"),right:new RegExp(o.type=="padding"?'padding-rights*:s*([^;"]+)':'margin-rights*:s*([^;"]+)',"im"),bottom:new RegExp(o.type=="padding"?'padding-bottoms*:s*([^;"]+)':'margin-bottoms*:s*([^;"]+)',"im")};b.each(["left","top","right","bottom"],function(){p[this]=b('<input type="text" />').attr("size",3).css("text-align","right").css("border-"+this,"2px solid red").bind("change",function(){b(this).val(a(b(this).val()));j()}).attr("name",o.name+"["+this+"]")});b.each(["uleft","utop","uright","ubottom"],function(){p[this]=b("<select />").append('<option value="px">px</option>').append('<option value="em">em</option>').append('<option value="pt">pt</option>').bind("change",function(){j()}).attr("name",o.name+"["+this+"]");if(o.percents){p[this].append('<option value="%">%</option>')}});this.empty().addClass(o["class"]).append(this.left).append(this.uleft).append(" x ").append(this.top).append(this.utop).append(" x ").append(this.right).append(this.uright).append(" x ").append(this.bottom).append(this.ubottom);this.val=function(v){if(!v&&v!==""){var c=a(this.left.val());var h=a(this.top.val());var t=a(this.right.val());var B=a(this.bottom.val());var C={left:c=="auto"||c==0?c:(c!==""?c+this.uleft.val():""),top:h=="auto"||h==0?h:(h!==""?h+this.utop.val():""),right:t=="auto"||t==0?t:(t!==""?t+this.uright.val():""),bottom:B=="auto"||B==0?B:(B!==""?B+this.ubottom.val():""),css:""};if(C.left!==""&&C.right!==""&&C.top!==""&&C.bottom!==""){if(C.left==C.right&&C.top==C.bottom){C.css=C.top+" "+C.left}else{C.css=C.top+" "+C.right+" "+C.bottom+" "+C.left}}return C}else{if(v.nodeName||v.css){if(!v.css){v=b(v)}var g={left:"",top:"",right:"",bottom:""};var r=(v.attr("style")||"").toLowerCase();if(r){r=b.trim(r);var f=r.match(this.regexps.main);if(f){var D=b.trim(f[1]).replace(/\s+/g," ").split(" ",4);g.top=D[0];g.right=D[1]&&D[1]!==""?D[1]:g.top;g.bottom=D[2]&&D[2]!==""?D[2]:g.top;g.left=D[3]&&D[3]!==""?D[3]:g.right}else{b.each(["left","top","right","bottom"],function(){var q=this.toString();f=r.match(p.regexps[q]);if(f){g[q]=f[1]}})}}var v=g}b.each(["left","top","right","bottom"],function(){var u=this.toString();p[u].val("");p["u"+u].val();if(typeof(v[u])!="undefined"&&v[u]!==null){v[u]=v[u].toString();var q=a(v[u]);p[u].val(q);var w=v[u].match(/(px|em|pt|%)/i);p["u"+u].val(w?w[1]:"px")}});return this}};function a(c){c=b.trim(c.toString());if(c[0]=="."){c="0"+c}n=parseFloat(c);return !isNaN(n)?n:(c=="auto"?c:"")}function j(){o.change&&o.change(p)}this.val(o.value);return this};b.fn.elPaddingInput.defaults={name:"el-paddinginput","class":"el-paddinginput",type:"padding",value:{},percents:true,change:null}})(jQuery);(function(b){b.fn.elSelect=function(C){var o=this;var E=this.eq(0);var D=b.extend({},b.fn.elSelect.defaults,C);var A=b('<input type="hidden" />').attr("name",D.name);var v=b("<label />").attr({unselectable:"on"}).addClass("rounded-left-3");var z=null;var w=null;if(E.get(0).nodeName=="SELECT"){D.src={};E.children("option").each(function(){D.src[b(this).val()]=b(this).text()});D.value=E.val();D.name=E.attr("name");E.replaceWith((E=b("<div />")))}if(!D.value||!D.src[D.val]){D.value=null;var B=0;for(var a in D.src){if(B++==0){D.value=a}}}this.val=function(c){if(!c&&c!==""){return A.val()}else{if(D.src[c]){A.val(c);x(c);if(z){z.children().each(function(){if(b(this).attr("name")==c){b(this).addClass("active")}else{b(this).removeClass("active")}})}}return this}};function x(f){var c=D.labelTpl||D.tpls[f]||D.tpl;v.html(c.replace(/%val/g,f).replace(/%label/,D.src[f])).children().attr({unselectable:"on"})}E.empty().addClass(D["class"]+" rounded-3").attr({unselectable:"on"}).append(A).append(v).hover(function(){b(this).addClass("hover")},function(){b(this).removeClass("hover")}).click(function(c){!z&&F();z.slideToggle();if(b.browser.msie&&!w){z.children().each(function(){w=Math.max(w,b(this).width())});if(w>z.width()){z.width(w+40)}}});this.val(D.value);function F(){z=b("<div />").addClass(D.listClass+" rounded-3").hide().appendTo(E.mouseleave(function(j){z.slideUp()}));for(var f in D.src){var h=D.tpls[f]||D.tpl;b("<div />").attr("name",f).append(b(h.replace(/%val/g,f).replace(/%label/g,D.src[f])).attr({unselectable:"on"})).appendTo(z).hover(function(){b(this).addClass("hover")},function(){b(this).removeClass("hover")}).click(function(k){k.stopPropagation();k.preventDefault();var j=b(this).attr("name");o.val(j);D.select(j);z.slideUp()})}var g=E.outerWidth();if(z.width()<g){z.width(g)}var c=z.height();if(D.maxHeight>0&&c>D.maxHeight){z.height(D.maxHeight)}o.val(A.val())}return this};b.fn.elSelect.defaults={name:"el-select","class":"el-select",listClass:"list",labelTpl:null,tpl:"<%val>%label</%val>",tpls:{},value:null,src:{},select:function(a){window.console&&window.console.log&&window.console.log("selected: "+a)},maxHeight:410}})(jQuery);(function(b){elRTE=function(v,q){if(!v||!v.nodeName){return alert('elRTE: argument "target" is not DOM Element')}var w=this,u;this.version="1.3";this.build="2011-06-23";this.options=b.extend(true,{},this.options,q);this.browser=b.browser;this.target=b(v);this.lang=(""+this.options.lang);this._i18n=new eli18n({textdomain:"rte",messages:{rte:this.i18Messages[this.lang]||{}}});this.rtl=!!(/^(ar|fa|he)$/.test(this.lang)&&this.i18Messages[this.lang]);if(this.rtl){this.options.cssClass+=" el-rte-rtl"}this.toolbar=b('<div class="toolbar"/>');this.iframe=document.createElement("iframe");this.iframe.setAttribute("frameborder",0);this.workzone=b('<div class="workzone"/>').append(this.iframe).append(this.source);this.statusbar=b('<div class="statusbar"/>');this.tabsbar=b('<div class="tabsbar"/>');this.editor=b('<div class="'+this.options.cssClass+'" />').append(this.toolbar).append(this.workzone).append(this.statusbar).append(this.tabsbar);this.doc=null;this.$doc=null;this.window=null;this.utils=new this.utils(this);this.dom=new this.dom(this);this.filter=new this.filter(this);this.updateHeight=function(){w.workzone.add(w.iframe).add(w.source).height(w.workzone.height())};this.resizable=function(c){var f=this;if(this.options.resizable&&b.fn.resizable){if(c){this.editor.resizable({handles:"se",alsoResize:this.workzone,minWidth:300,minHeight:200}).bind("resize",f.updateHeight)}else{this.editor.resizable("destroy").unbind("resize",f.updateHeight)}}};this.editor.insertAfter(v);var r="";if(v.nodeName=="TEXTAREA"){this.source=this.target;this.source.insertAfter(this.iframe).hide();r=this.target.val()}else{this.source=b("<textarea />").insertAfter(this.iframe).hide();r=this.target.hide().html()}this.source.attr("name",this.target.attr("name")||this.target.attr("id"));r=b.trim(r);if(!r){r=" "}if(this.options.allowSource){this.tabsbar.append('<div class="tab editor rounded-bottom-7 active">'+w.i18n("Editor")+'</div><div class="tab source rounded-bottom-7">'+w.i18n("Source")+'</div><div class="clearfix" style="clear:both"/>').children(".tab").click(function(c){if(!b(this).hasClass("active")){w.tabsbar.children(".tab").toggleClass("active");w.workzone.children().toggle();if(b(this).hasClass("editor")){w.updateEditor();w.window.focus();w.ui.update(true)}else{w.updateSource();w.source.focus();if(b.browser.msie){}else{w.source[0].setSelectionRange(0,0)}w.ui.disable();w.statusbar.empty()}}})}this.window=this.iframe.contentWindow;this.doc=this.iframe.contentWindow.document;this.$doc=b(this.doc);u='<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />';b.each(w.options.cssfiles,function(){u+='<link rel="stylesheet" type="text/css" href="'+this+'" />'});this.doc.open();var t=this.filter.wysiwyg(r),a=this.rtl?' class="el-rte-rtl"':"";this.doc.write(w.options.doctype+u+"</head><body"+a+">"+(t)+"</body></html>");this.doc.close();if(b.browser.msie){this.doc.body.contentEditable=true}else{try{this.doc.designMode="on"}catch(p){}this.doc.execCommand("styleWithCSS",false,this.options.styleWithCSS)}if(this.options.height>0){this.workzone.height(this.options.height)}if(this.options.width>0){this.editor.width(this.options.width)}this.updateHeight();this.resizable(true);this.window.focus();this.history=new this.history(this);this.selection=new this.selection(this);this.ui=new this.ui(this);this.target.parents("form").bind("submit.elfinder",function(c){w.source.parents("form").find('[name="el-select"]').remove();w.beforeSave()});this.source.bind("keydown",function(f){if(f.keyCode==9){f.preventDefault();if(b.browser.msie){var h=document.selection.createRange();h.text="\t"+h.text;this.focus()}else{var g=this.value.substr(0,this.selectionStart),c=this.value.substr(this.selectionEnd);this.value=g+"\t"+c;this.setSelectionRange(g.length+1,g.length+1)}}});b(this.doc.body).bind("dragend",function(c){setTimeout(function(){try{w.window.focus();var f=w.selection.getBookmark();w.selection.moveToBookmark(f);w.ui.update()}catch(g){}},200)});this.typing=false;this.lastKey=null;this.$doc.bind("mouseup",function(){w.typing=false;w.lastKey=null;w.ui.update()}).bind("keyup",function(c){if((c.keyCode>=8&&c.keyCode<=13)||(c.keyCode>=32&&c.keyCode<=40)||c.keyCode==46||(c.keyCode>=96&&c.keyCode<=111)){w.ui.update()}}).bind("keydown",function(f){if((f.metaKey||f.ctrlKey)&&f.keyCode==65){w.ui.update()}else{if(f.keyCode==13){var c=w.selection.getNode();if(w.dom.selfOrParent(c,/^PRE$/)){w.selection.insertNode(w.doc.createTextNode("\r\n"));return false}else{if(b.browser.safari&&f.shiftKey){w.selection.insertNode(w.doc.createElement("br"));return false}}}}if((f.keyCode>=48&&f.keyCode<=57)||f.keyCode==61||f.keyCode==109||(f.keyCode>=65&&f.keyCode<=90)||f.keyCode==188||f.keyCode==190||f.keyCode==191||(f.keyCode>=219&&f.keyCode<=222)){if(!w.typing){w.history.add(true)}w.typing=true;w.lastKey=null}else{if(f.keyCode==8||f.keyCode==46||f.keyCode==32||f.keyCode==13){if(f.keyCode!=w.lastKey){w.history.add(true)}w.lastKey=f.keyCode;w.typing=false}}if(f.keyCode==32&&b.browser.opera){w.selection.insertNode(w.doc.createTextNode(" "));return false}}).bind("paste",function(f){if(!w.options.allowPaste){f.stopPropagation();f.preventDefault()}else{var c=b(w.dom.create("div"))[0],g=w.doc.createTextNode("_");w.history.add(true);w.typing=true;w.lastKey=null;c.appendChild(g);w.selection.deleteContents().insertNode(c);w.selection.select(g);setTimeout(function(){if(c.parentNode){b(c).html(w.filter.proccess("paste",b(c).html()));g=c.lastChild;w.dom.unwrap(c);if(g){w.selection.select(g);w.selection.collapse(false)}}else{c.parentNode&&c.parentNode.removeChild(c);w.val(w.filter.proccess("paste",w.filter.wysiwyg2wysiwyg(b(w.doc.body).html())));w.selection.select(w.doc.body.firstChild);w.selection.collapse(true)}b(w.doc.body).mouseup()},15)}});if(b.browser.msie){this.$doc.bind("keyup",function(c){if(c.keyCode==86&&(c.metaKey||c.ctrlKey)){w.history.add(true);w.typing=true;w.lastKey=null;w.selection.saveIERange();w.val(w.filter.proccess("paste",w.filter.wysiwyg2wysiwyg(b(w.doc.body).html())));w.selection.restoreIERange();b(w.doc.body).mouseup();this.ui.update()}})}if(b.browser.safari){this.$doc.bind("click",function(c){b(w.doc.body).find(".elrte-webkit-hl").removeClass("elrte-webkit-hl");if(c.target.nodeName=="IMG"){b(c.target).addClass("elrte-webkit-hl")}}).bind("keyup",function(c){b(w.doc.body).find(".elrte-webkit-hl").removeClass("elrte-webkit-hl")})}this.window.focus();this.destroy=function(){this.updateSource();this.target.is("textarea")?this.target.val(b.trim(this.source.val())):this.target.html(b.trim(this.source.val()));this.editor.remove();this.target.show().parents("form").unbind("submit.elfinder")}};elRTE.prototype.i18n=function(a){return this._i18n.translate(a)};elRTE.prototype.open=function(){this.editor.show()};elRTE.prototype.close=function(){this.editor.hide()};elRTE.prototype.updateEditor=function(){this.val(this.source.val())};elRTE.prototype.updateSource=function(){this.source.val(this.filter.source(b(this.doc.body).html()))};elRTE.prototype.val=function(a){if(typeof(a)=="string"){a=""+a;if(this.source.is(":visible")){this.source.val(this.filter.source2source(a))}else{if(b.browser.msie){this.doc.body.innerHTML="<br />"+this.filter.wysiwyg(a);this.doc.body.removeChild(this.doc.body.firstChild)}else{this.doc.body.innerHTML=this.filter.wysiwyg(a)}}}else{if(this.source.is(":visible")){return this.filter.source2source(this.source.val()).trim()}else{return this.filter.source(b(this.doc.body).html()).trim()}}};elRTE.prototype.beforeSave=function(){this.source.val(b.trim(this.val())||"")};elRTE.prototype.save=function(){this.beforeSave();this.editor.parents("form").submit()};elRTE.prototype.log=function(a){if(window.console&&window.console.log){window.console.log(a)}};elRTE.prototype.i18Messages={};b.fn.elrte=function(h,a){var j=typeof(h)=="string"?h:"",k;this.each(function(){if(!this.elrte){this.elrte=new elRTE(this,typeof(h)=="object"?h:{})}switch(j){case"open":case"show":this.elrte.open();break;case"close":case"hide":this.elrte.close();break;case"updateSource":this.elrte.updateSource();break;case"destroy":this.elrte.destroy()}});if(j=="val"){if(!this.length){return""}else{if(this.length==1){return a?this[0].elrte.val(a):this[0].elrte.val()}else{k={};this.each(function(){k[this.elrte.source.attr("name")]=this.elrte.val()});return k}}}return this}})(jQuery);(function(b){elRTE.prototype.dom=function(f){this.rte=f;var a=this;this.regExp={textNodes:/^(A|ABBR|ACRONYM|ADDRESS|B|BDO|BIG|BLOCKQUOTE|CAPTION|CENTER|CITE|CODE|DD|DEL|DFN|DIV|DT|EM|FIELDSET|FONT|H[1-6]|I|INS|KBD|LABEL|LEGEND|LI|MARQUEE|NOBR|NOEMBED|P|PRE|Q|SAMP|SMALL|SPAN|STRIKE|STRONG|SUB|SUP|TD|TH|TT|VAR)$/,textContainsNodes:/^(A|ABBR|ACRONYM|ADDRESS|B|BDO|BIG|BLOCKQUOTE|CAPTION|CENTER|CITE|CODE|DD|DEL|DFN|DIV|DL|DT|EM|FIELDSET|FONT|H[1-6]|I|INS|KBD|LABEL|LEGEND|LI|MARQUEE|NOBR|NOEMBED|OL|P|PRE|Q|SAMP|SMALL|SPAN|STRIKE|STRONG|SUB|SUP|TABLE|THEAD|TBODY|TFOOT|TD|TH|TR|TT|UL|VAR)$/,block:/^(APPLET|BLOCKQUOTE|BR|CAPTION|CENTER|COL|COLGROUP|DD|DIV|DL|DT|H[1-6]|EMBED|FIELDSET|LI|MARQUEE|NOBR|OBJECT|OL|P|PRE|TABLE|THEAD|TBODY|TFOOT|TD|TH|TR|UL)$/,selectionBlock:/^(APPLET|BLOCKQUOTE|BR|CAPTION|CENTER|COL|COLGROUP|DD|DIV|DL|DT|H[1-6]|EMBED|FIELDSET|LI|MARQUEE|NOBR|OBJECT|OL|P|PRE|TD|TH|TR|UL)$/,header:/^H[1-6]$/,formElement:/^(FORM|INPUT|HIDDEN|TEXTAREA|SELECT|BUTTON)$/};this.root=function(){return this.rte.body};this.create=function(c){return this.rte.doc.createElement(c)};this.createBookmark=function(){var c=this.rte.doc.createElement("span");c.id="elrte-bm-"+Math.random().toString().substr(2);b(c).addClass("elrtebm elrte-protected");return c};this.indexOf=function(c){var h=0;c=b(c);while((c=c.prev())&&c.length){h++}return h};this.attr=function(c,k){var j="";if(c.nodeType==1){j=b(c).attr(k);if(j&&k!="src"&&k!="href"&&k!="title"&&k!="alt"){j=j.toString().toLowerCase()}}return j||""};this.findCommonAncestor=function(q,r){if(!q||!r){return this.rte.log("dom.findCommonAncestor invalid arguments")}if(q==r){return q}else{if(q.nodeName=="BODY"||r.nodeName=="BODY"){return this.rte.doc.body}}var w=b(q).parents(),c=b(r).parents(),u=c.length-1,v=c[u];for(var t=w.length-1;t>=0;t--,u--){if(w[t]==c[u]){v=w[t]}else{break}}return v};this.isEmpty=function(c){if(c.nodeType==1){return this.regExp.textNodes.test(c.nodeName)?b.trim(b(c).text()).length==0:false}else{if(c.nodeType==3){return/^(TABLE|THEAD|TFOOT|TBODY|TR|UL|OL|DL)$/.test(c.parentNode.nodeName)||c.nodeValue==""||(b.trim(c.nodeValue).length==0&&!(c.nextSibling&&c.previousSibling&&c.nextSibling.nodeType==1&&c.previousSibling.nodeType==1&&!this.regExp.block.test(c.nextSibling.nodeName)&&!this.regExp.block.test(c.previousSibling.nodeName)))}}return true};this.next=function(c){while(c.nextSibling&&(c=c.nextSibling)){if(c.nodeType==1||(c.nodeType==3&&!this.isEmpty(c))){return c}}return null};this.prev=function(c){while(c.previousSibling&&(c=c.previousSibling)){if(c.nodeType==1||(c.nodeType==3&&!this.isEmpty(c))){return c}}return null};this.isPrev=function(c,h){while((c=this.prev(c))){if(c==h){return true}}return false};this.nextAll=function(c){var h=[];while((c=this.next(c))){h.push(c)}return h};this.prevAll=function(c){var h=[];while((c=this.prev(c))){h.push(c)}return h};this.toLineEnd=function(c){var h=[];while((c=this.next(c))&&c.nodeName!="BR"&&c.nodeName!="HR"&&this.isInline(c)){h.push(c)}return h};this.toLineStart=function(c){var h=[];while((c=this.prev(c))&&c.nodeName!="BR"&&c.nodeName!="HR"&&this.isInline(c)){h.unshift(c)}return h};this.isFirstNotEmpty=function(c){while((c=this.prev(c))){if(c.nodeType==1||(c.nodeType==3&&b.trim(c.nodeValue)!="")){return false}}return true};this.isLastNotEmpty=function(c){while((c=this.next(c))){if(!this.isEmpty(c)){return false}}return true};this.isOnlyNotEmpty=function(c){return this.isFirstNotEmpty(c)&&this.isLastNotEmpty(c)};this.findLastNotEmpty=function(c){this.rte.log("findLastNotEmpty Who is here 0_o");if(c.nodeType==1&&(l=c.lastChild)){if(!this.isEmpty(l)){return l}while(l.previousSibling&&(l=l.previousSibling)){if(!this.isEmpty(l)){return l}}}return false};this.isInline=function(c){if(c.nodeType==3){return true}else{if(c.nodeType==1){c=b(c);var k=c.css("display");var o=c.css("float");return k=="inline"||k=="inline-block"||o=="left"||o=="right"}}return true};this.is=function(c,j){if(c&&c.nodeName){if(typeof(j)=="string"){j=this.regExp[j]||/.?/}if(j instanceof RegExp&&c.nodeName){return j.test(c.nodeName)}else{if(typeof(j)=="function"){return j(c)}}}return false};this.filter=function(c,k){var p=[],o;if(!c.push){return this.is(c,k)?c:null}for(o=0;o<c.length;o++){if(this.is(c[o],k)){p.push(c[o])}}return p};this.parents=function(c,j){var k=[];while(c&&(c=c.parentNode)&&c.nodeName!="BODY"&&c.nodeName!="HTML"){if(this.is(c,j)){k.push(c)}}return k};this.parent=function(c,j){return this.parents(c,j)[0]||null};this.selfOrParent=function(c,j,k){return this.is(c,j)?c:this.parent(c,k||j)};this.selfOrParentLink=function(c){c=this.selfOrParent(c,/^A$/);return c&&c.href?c:null};this.selfOrParentAnchor=function(c){c=this.selfOrParent(c,/^A$/);return c&&!c.href&&c.name?c:null};this.childLinks=function(c){var h=[];b("a[href]",c).each(function(){h.push(this)});return h};this.selectionHas=function(k){var c=this.rte.selection.cloneContents(),o;if(c&&c.childNodes&&c.childNodes.length){for(o=0;o<c.childNodes.length;o++){if(typeof(k)=="function"){if(k(c.childNodes[o])){return true}}else{if(c instanceof RegExp){if(k.test(c.childNodes[o].nodeName)){return true}}}}}return false};this.wrap=function(c,h){c=b.isArray(c)?c:[c];h=h.nodeName?h:this.create(h);if(c[0]&&c[0].nodeType&&c[0].parentNode){h=c[0].parentNode.insertBefore(h,c[0]);b(c).each(function(){if(this!=h){h.appendChild(this)}})}return h};this.unwrap=function(c){if(c&&c.parentNode){while(c.firstChild){c.parentNode.insertBefore(c.firstChild,c)}c.parentNode.removeChild(c)}};this.wrapContents=function(c,k){k=k.nodeName?k:this.create(k);for(var j=0;j<c.childNodes.length;j++){k.appendChild(c.childNodes[j])}c.appendChild(k);return k};this.cleanNode=function(c){if(c.nodeType!=1){return}if(/^(P|LI)$/.test(c.nodeName)&&(l=this.findLastNotEmpty(c))&&l.nodeName=="BR"){b(l).remove()}$n=b(c);$n.children().each(function(){this.cleanNode(this)});if(c.nodeName!="BODY"&&!/^(TABLE|TR|TD)$/.test(c)&&this.isEmpty(c)){return $n.remove()}if($n.attr("style")===""){$n.removeAttr("style")}if(this.rte.browser.safari&&$n.hasClass("Apple-span")){$n.removeClass("Apple-span")}if(c.nodeName=="SPAN"&&!$n.attr("style")&&!$n.attr("class")&&!$n.attr("id")){$n.replaceWith($n.html())}};this.cleanChildNodes=function(c){var h=this.cleanNode;b(c).children().each(function(){h(this)})};this.tableMatrix=function(c){var k=[];if(c&&c.nodeName=="TABLE"){var o=0;function p(h){for(var g=0;g<=o;g++){if(!k[h][g]){return g}}}b(c).find("tr").each(function(g){if(!b.isArray(k[g])){k[g]=[]}b(this).children("td,th").each(function(){var A=parseInt(b(this).attr("colspan")||1);var w=parseInt(b(this).attr("rowspan")||1);var x=p(g);for(var h=0;h<w;h++){for(var B=0;B<A;B++){var z=g+h;if(!b.isArray(k[z])){k[z]=[]}var j=B==0&&h==0?this:(h==0?B:"-");k[z][x+B]=j}}o=Math.max(o,k[g].length)})})}return k};this.indexesOfCell=function(c,k){for(var p=0;p<k.length;p++){for(var o=0;o<k[p].length;o++){if(k[p][o]==c){return[p,o]}}}};this.fixTable=function(w){if(w&&w.nodeName=="TABLE"){var t=b(w);var x=this.tableMatrix(w);var v=0;b.each(x,function(){v=Math.max(v,this.length)});if(v==0){return t.remove()}for(var c=0;c<x.length;c++){var u=x[c].length;if(u==0){t.find("tr").eq(c).remove()}else{if(u<v){var r=v-u;var z=t.find("tr").eq(c);for(i=0;i<r;i++){z.append("<td>&nbsp;</td>")}}}}}};this.tableColumn=function(A,B,w){A=this.selfOrParent(A,/^TD|TH$/);var z=this.selfOrParent(A,/^TABLE$/);ret=[];info={offset:[],delta:[]};if(A&&z){w&&this.fixTable(z);var E=this.tableMatrix(z);var D=false;var F;for(var C=0;C<E.length;C++){for(var c=0;c<E[C].length;c++){if(E[C][c]==A){F=c;D=true;break}}if(D){break}}if(F>=0){for(var C=0;C<E.length;C++){var x=E[C][F]||null;if(x){if(x.nodeName){ret.push(x);if(B){info.delta.push(0);info.offset.push(F)}}else{var r=parseInt(x);if(!isNaN(r)&&E[C][F-r]&&E[C][F-r].nodeName){ret.push(E[C][F-r]);if(B){info.delta.push(r);info.offset.push(F)}}}}}}}return !B?ret:{column:ret,info:info}}}})(jQuery);(function(b){elRTE.prototype.filter=function(h){var a=this,g=b("<span/>").addClass("elrtetesturl").appendTo(document.body)[0];this.url=(typeof(g.currentStyle)!="undefined"?g.currentStyle.backgroundImage:document.defaultView.getComputedStyle(g,null)["backgroundImage"]).replace(/^url\((['"]?)([\s\S]+\/)[\s\S]+\1\)$/i,"$2");b(g).remove();this.rte=h;this.xhtml=/xhtml/i.test(h.options.doctype);this.boolAttrs=h.utils.makeObject("checked,compact,declare,defer,disabled,ismap,multiple,nohref,noresize,noshade,nowrap,readonly,selected".split(","));this.tagRegExp=/<(\/?)([\w:]+)((?:\s+[a-z\-]+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*\/?>/g;this.openTagRegExp=/<([\w:]+)((?:\s+\w+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*\/?>/g;this.attrRegExp=/(\w+)(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^\s]+))?/g;this.scriptRegExp=/<script([^>]*)>([\s\S]*?)<\/script>/gi;this.styleRegExp=/(<style([^>]*)>[\s\S]*?<\/style>)/gi;this.linkRegExp=/(<link([^>]+)>)/gi;this.cdataRegExp=/<!\[CDATA\[([\s\S]+)\]\]>/g;this.objRegExp=/<object([^>]*)>([\s\S]*?)<\/object>/gi;this.embRegExp=/<(embed)((?:\s+\w+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*>/gi;this.paramRegExp=/<(param)((?:\s+\w+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*>/gi;this.iframeRegExp=/<iframe([^>]*)>([\s\S]*?)<\/iframe>/gi;this.yMapsRegExp=/<div\s+([^>]*id\s*=\s*('|")?YMapsID[^>]*)>/gi;this.gMapsRegExp=/<iframe\s+([^>]*src\s*=\s*"http:\/\/maps\.google\.\w+[^>]*)>([\s\S]*?)<\/iframe>/gi;this.videoHostRegExp=/^(http:\/\/[\w\.]*)?(youtube|vimeo|rutube).*/i;this.serviceClassRegExp=/<(\w+)([^>]*class\s*=\s*"[^>]*elrte-[^>]*)>\s*(<\/\1>)?/gi;this.pagebreakRegExp=/<(\w+)([^>]*style\s*=\s*"[^>]*page-break[^>]*)>\s*(<\/\1>)?/gi;this.pbRegExp=new RegExp("<!-- pagebreak -->","gi");this.allowTags=h.options.allowTags.length?h.utils.makeObject(h.options.allowTags):null;this.denyTags=h.options.denyTags.length?h.utils.makeObject(h.options.denyTags):null;this.denyAttr=h.options.denyAttr?h.utils.makeObject(h.options.denyAttr):null;this.pasteDenyAttr=h.options.pasteDenyAttr?h.utils.makeObject(h.options.pasteDenyAttr):null;this.fontSize=["medium","xx-small","small","medium","large","x-large","xx-large"];this.fontFamily={"sans-serif":/^(arial|tahoma|verdana)$/i,serif:/^(times|times new roman)$/i,monospace:/^courier$/i};this.scripts={};this._chains={};b.each(this.chains,function(c){a._chains[c]=[];b.each(this,function(k,f){typeof(a.rules[f])=="function"&&a._chains[c].push(a.rules[f])})});this.proccess=function(c,f){f=b.trim(f).replace(/^\s*(&nbsp;)+/gi,"").replace(/(&nbsp;|<br[^>]*>)+\s*$/gi,"");b.each(this._chains[c]||[],function(){f=this.call(a,f)});f=f.replace(/\t/g,"  ").replace(/\r/g,"").replace(/\s*\n\s*\n+/g,"\n")+"  ";return b.trim(f)?f:" "};this.wysiwyg=function(c){return this.proccess("wysiwyg",c)};this.source=function(c){return this.proccess("source",c)};this.source2source=function(c){return this.proccess("source2source",c)};this.wysiwyg2wysiwyg=function(c){return this.proccess("wysiwyg2wysiwyg",c)};this.parseAttrs=function(v){var f={},r=this.boolAttrs,t=v.match(this.attrRegExp),w,u,c;t&&b.each(t,function(k,j){w=j.split("=");u=b.trim(w[0]).toLowerCase();if(w.length>2){w.shift();c=w.join("=")}else{c=r[u]||w[1]||""}f[u]=b.trim(c).replace(/^('|")(.*)(\1)$/,"$2")});f.style=this.rte.utils.parseStyle(f.style);f["class"]=this.rte.utils.parseClass(f["class"]||"");return f};this.serializeAttrs=function(p,c){var f=[],o=this;b.each(p,function(j,k){if(j=="style"){k=o.rte.utils.serializeStyle(k,c)}else{if(j=="class"){k=o.rte.utils.serializeClass(k)}}k&&f.push(j+'="'+k+'"')});return f.join(" ")};this.cleanAttrs=function(q,f){var p=this,r=this.replaceAttrs;b.each(q["class"],function(j){/^(Apple-style-span|mso\w+)$/i.test(j)&&delete q["class"][j]});function c(j){return j+(/\d$/.test(j)?"px":"")}b.each(q,function(j,k){r[j]&&r[j].call(p,q,f);if(j=="style"){b.each(k,function(o,u){switch(o){case"mso-padding-alt":case"mso-padding-top-alt":case"mso-padding-right-alt":case"mso-padding-bottom-alt":case"mso-padding-left-alt":case"mso-margin-alt":case"mso-margin-top-alt":case"mso-margin-right-alt":case"mso-margin-bottom-alt":case"mso-margin-left-alt":case"mso-table-layout-alt":case"mso-height":case"mso-width":case"mso-vertical-align-alt":q.style[o.replace(/^mso-|-alt$/g,"")]=c(u);delete q.style[o];break;case"horiz-align":q.style["text-align"]=u;delete q.style[o];break;case"vert-align":q.style["vertical-align"]=u;delete q.style[o];break;case"font-color":case"mso-foreground":q.style.color=u;delete q.style[o];break;case"mso-background":case"mso-highlight":q.style.background=u;delete q.style[o];break;case"mso-default-height":q.style["min-height"]=c(u);delete q.style[o];break;case"mso-default-width":q.style["min-width"]=c(u);delete q.style[o];break;case"mso-padding-between-alt":q.style["border-collapse"]="separate";q.style["border-spacing"]=c(u);delete q.style[o];break;case"text-line-through":if(u.match(/(single|double)/i)){q.style["text-decoration"]="line-through"}delete q.style[o];break;case"mso-zero-height":if(u=="yes"){q.style.display="none"}delete q.style[o];break;case"font-weight":if(u==700){q.style["font-weight"]="bold"}break;default:if(o.match(/^(mso|column|font-emph|lang|layout|line-break|list-image|nav|panose|punct|row|ruby|sep|size|src|tab-|table-border|text-(?!align|decor|indent|trans)|top-bar|version|vnd|word-break)/)){delete q.style[o]}}})}});return q}};elRTE.prototype.filter.prototype.replaceTags={b:{tag:"strong"},big:{tag:"span",style:{"font-size":"large"}},center:{tag:"div",style:{"text-align":"center"}},i:{tag:"em"},font:{tag:"span"},nobr:{tag:"span",style:{"white-space":"nowrap"}},menu:{tag:"ul"},plaintext:{tag:"pre"},s:{tag:"strike"},small:{tag:"span",style:{"font-size":"small"}},u:{tag:"span",style:{"text-decoration":"underline"}},xmp:{tag:"pre"}};elRTE.prototype.filter.prototype.replaceAttrs={align:function(a,f){switch(f){case"img":a.style[a.align.match(/(left|right)/)?"float":"vertical-align"]=a.align;break;case"table":if(a.align=="center"){a.style["margin-left"]=a.style["margin-right"]="auto"}else{a.style["float"]=a.align}break;default:a.style["text-align"]=a.align}delete a.align},border:function(a){!a.style["border-width"]&&(a.style["border-width"]=(parseInt(a.border)||1)+"px");!a.style["border-style"]&&(a.style["border-style"]="solid");delete a.border},bordercolor:function(a){!a.style["border-color"]&&(a.style["border-color"]=a.bordercolor);delete a.bordercolor},background:function(a){!a.style["background-image"]&&(a.style["background-image"]="url("+a.background+")");delete a.background},bgcolor:function(a){!a.style["background-color"]&&(a.style["background-color"]=a.bgcolor);delete a.bgcolor},clear:function(a){a.style.clear=a.clear=="all"?"both":a.clear;delete a.clear},color:function(a){!a.style.color&&(a.style.color=a.color);delete a.color},face:function(a){var f=a.face.toLowerCase();b.each(this.fontFamily,function(c,h){if(f.match(h)){a.style["font-family"]=f+","+c}});delete a.face},hspace:function(a,g){if(g=="img"){var h=parseInt(a.hspace)||0;!a.style["margin-left"]&&(a.style["margin-left"]=h+"px");!a.style["margin-right"]&&(a.style["margin-right"]=h+"px");delete a.hspace}},size:function(a,f){if(f!="input"){a.style["font-size"]=this.fontSize[parseInt(a.size)||0]||"medium";delete a.size}},valign:function(a){if(!a.style["vertical-align"]){a.style["vertical-align"]=a.valign}delete a.valign},vspace:function(a,g){if(g=="img"){var h=parseInt(a.vspace)||0;!a.style["margin-top"]&&(a.style["margin-top"]=h+"px");!a.style["margin-bottom"]&&(a.style["margin-bottom"]=h+"px");delete a.hspace}}};elRTE.prototype.filter.prototype.rules={allowedTags:function(f){var a=this.allowTags;return a?f.replace(this.tagRegExp,function(k,c,j){return a[j.toLowerCase()]?k:""}):f},deniedTags:function(a){var f=this.denyTags;return f?a.replace(this.tagRegExp,function(k,c,j){return f[j.toLowerCase()]?"":k}):a},clean:function(p){var r=this,a=this.replaceTags,o=this.replaceAttrs,q=this.denyAttr,k;p=p.replace(/<!DOCTYPE([\s\S]*)>/gi,"").replace(/<p [^>]*class="?MsoHeading"?[^>]*>(.*?)<\/p>/gi,"<p><strong>$1</strong></p>").replace(/<span\s+style\s*=\s*"\s*mso-spacerun\s*:\s*yes\s*;?\s*"\s*>([\s&nbsp;]*)<\/span>/gi,"$1").replace(/(<p[^>]*>\s*<\/p>|<p[^>]*\/>)/gi,"<br>").replace(/(<\/p>)(?:\s*<br\s*\/?>\s*|\s*&nbsp;\s*)+\s*(<p[^>]*>)/gi,function(g,c,f){return c+"\n"+f}).replace(this.tagRegExp,function(h,f,g,c){g=g.toLowerCase();if(f){return"</"+(a[g]?a[g].tag:g)+">"}c=r.cleanAttrs(r.parseAttrs(c||""),g);if(a[g]){a[g].style&&b.extend(c.style,a[g].style);g=a[g].tag}q&&b.each(c,function(j){if(q[j]){delete c[j]}});c=r.serializeAttrs(c);return"<"+g+(c?" ":"")+c+">"});k=b("<div>"+p+"</div>");k.find("span:not([id]):not([class])").each(function(){var c=b(this);if(!c.attr("style")){b.trim(c.html()).length?r.rte.dom.unwrap(this):c.remove()}}).end().find("span span:only-child").each(function(){var x=b(this),h=x.parent().eq(0),j=x.attr("id"),g=h.attr("id"),c,t,f;if(r.rte.dom.isOnlyNotEmpty(this)&&(!j||!g)){f=b.trim(h.attr("class")+" "+x.attr("class"));f&&h.attr("class",f);t=r.rte.utils.serializeStyle(b.extend(r.rte.utils.parseStyle(b(this).attr("style")||""),r.rte.utils.parseStyle(b(h).attr("style")||"")));t&&h.attr("style",t);c=j||g;c&&h.attr("id",c);this.firstChild?b(this.firstChild).unwrap():x.remove()}}).end().find("a[name]").each(function(){b(this).addClass("elrte-protected elrte-anchor")});return k.html()},cleanPaste:function(h){var a=this,g=this.pasteDenyAttr;h=h.replace(this.scriptRegExp,"").replace(this.styleRegExp,"").replace(this.linkRegExp,"").replace(this.cdataRegExp,"").replace(/\<\!--[\s\S]*?--\>/g,"");if(this.rte.options.pasteOnlyText){h=h.replace(this.tagRegExp,function(k,c,f){return/br/i.test(f)||(c&&/h[1-6]|p|ol|ul|li|div|blockquote|tr/i)?"<br>":""}).replace(/(&nbsp;|<br[^>]*>)+\s*$/gi,"")}else{if(g){h=h.replace(this.openTagRegExp,function(f,c,k){k=a.parseAttrs(k);b.each(k,function(j){if(g[j]){delete k[j]}});k=a.serializeAttrs(k,true);return"<"+c+(k?" ":"")+k+">"})}}return h},replace:function(t){var a=this,B=this.rte.options.replace||[],x;if(B.length){b.each(B,function(f,c){if(typeof(c)=="function"){t=c.call(a,t)}})}function u(o,f){var F=c(),h=F&&a.videoHostRegExp.test(F)?F.replace(a.videoHostRegExp,"$2"):f.replace(/^\w+\/(.+)/,"$1"),g=parseInt((o.obj?o.obj.width||o.obj.style.width:0)||(o.embed?o.embed.width||o.embed.style.width:0))||150,j=parseInt((o.obj?o.obj.height||o.obj.style.height:0)||(o.embed?o.embed.height||o.embed.style.height:0))||100,p="media"+Math.random().toString().substring(2),q="",k;function c(){if(o.embed&&o.embed.src){return o.embed.src}if(o.params&&o.params.length){k=o.params.length;while(k--){if(o.params[k].name=="src"||o.params[k].name=="movie"){return o.params[k].value}}}}if(o.obj&&o.obj.style&&o.obj.style["float"]){q=' style="float:'+o.obj.style["float"]+'"'}a.scripts[p]=o;return'<img src="'+a.url+'pixel.gif" class="elrte-media elrte-media-'+h+' elrte-protected" title="'+(F?a.rte.utils.encode(F):"")+'" rel="'+p+'" width="'+g+'" height="'+j+'"'+q+">"}t=t.replace(this.styleRegExp,"<!-- ELRTE_COMMENT$1 -->").replace(this.linkRegExp,"<!-- ELRTE_COMMENT$1-->").replace(this.cdataRegExp,"<!--[CDATA[$1]]-->").replace(this.scriptRegExp,function(g,h,f){var c;if(a.denyTags.script){return""}c="script"+Math.random().toString().substring(2);h=a.parseAttrs(h);!h.type&&(h.type="text/javascript");a.scripts[c]="<script "+a.serializeAttrs(h)+">"+f+"<\/script>";return"<!-- ELRTE_SCRIPT:"+(c)+" -->"}).replace(this.yMapsRegExp,function(c,f){f=a.parseAttrs(f);f["class"]["elrte-yandex-maps"]="elrte-yandex-maps";f["class"]["elrte-protected"]="elrte-protected";return"<div "+a.serializeAttrs(f)+">"}).replace(this.gMapsRegExp,function(f,g){var j="gmaps"+Math.random().toString().substring(2),h,c;g=a.parseAttrs(g);h=parseInt(g.width||g.style.width||100);c=parseInt(g.height||g.style.height||100);a.scripts[j]=f;return'<img src="'+a.url+'pixel.gif" class="elrte-google-maps elrte-protected" id="'+j+'" style="width:'+h+"px;height:"+c+'px">'}).replace(this.objRegExp,function(f,h,k){var j=k.match(a.embRegExp),c={obj:a.parseAttrs(h),embed:j&&j.length?a.parseAttrs(j[0].substring(7)):null,params:[]},g=a.rte.utils.mediaInfo(c.embed?c.embed.type||"":"",c.obj.classid||"");if(g){if((j=k.match(a.paramRegExp))){b.each(j,function(p,o){c.params.push(a.parseAttrs(o.substring(6)))})}!c.obj.classid&&(c.obj.classid=g.classid[0]);!c.obj.codebase&&(c.obj.codebase=g.codebase);c.embed&&!c.embed.type&&(c.embed.type=g.type);c.obj.width=="1"&&delete c.obj.width;c.obj.height=="1"&&delete c.obj.height;if(c.embed){c.embed.width=="1"&&delete c.embed.width;c.embed.height=="1"&&delete c.embed.height}return u(c,g.type)}return f}).replace(this.embRegExp,function(f,c,h){var h=a.parseAttrs(h),g=a.rte.utils.mediaInfo(h.type||"");h.width=="1"&&delete h.width;h.height=="1"&&delete h.height;return g?u({embed:h},g.type):f}).replace(this.iframeRegExp,function(f,h){var h=a.parseAttrs(h);var j=h.style.width||(parseInt(h.width)>1?parseInt(h.width)+"px":"100px");var k=h.style.height||(parseInt(h.height)>1?parseInt(h.height)+"px":"100px");var c="iframe"+Math.random().toString().substring(2);a.scripts[c]=f;var g='<img id="'+c+'" src="'+a.url+'pixel.gif" class="elrte-protected elrte-iframe" style="width:'+j+"; height:"+k+'">';return g}).replace(this.vimeoRegExp,function(f,c,g){g=a.parseAttrs(g);delete g.frameborder;g.width=="1"&&delete g.width;g.height=="1"&&delete g.height;g.type="application/x-shockwave-flash";return u({embed:g},"application/x-shockwave-flash")}).replace(/<\/(embed|param)>/gi,"").replace(this.pbRegExp,function(){return'<img src="'+a.url+'pixel.gif" class="elrte-protected elrte-pagebreak">'});x=b("<div>"+t+"</div>");if(!this.rte.options.allowTextNodes){var w=this.rte.dom,A=[],r=[];if(b.browser.msie){for(var v=0;v<x[0].childNodes.length;v++){A.push(x[0].childNodes[v])}}else{A=Array.prototype.slice.call(x[0].childNodes)}function z(){if(r.length&&w.filter(r,"notEmpty").length){w.wrap(r,document.createElement("p"))}r=[]}b.each(A,function(f,c){if(w.is(c,"block")){z()}else{if(r.length&&c.previousSibling!=r[r.length-1]){z()}r.push(c)}});z()}return x.html()},restore:function(h){var a=this,g=this.rte.options.restore||[];if(g.length){b.each(g,function(f,c){if(typeof(c)=="function"){h=c.call(a,h)}})}h=h.replace(/\<\!--\[CDATA\[([\s\S]*?)\]\]--\>/gi,"<![CDATA[$1]]>").replace(/\<\!--\s*ELRTE_SCRIPT\:\s*(script\d+)\s*--\>/gi,function(f,c){if(a.scripts[c]){f=a.scripts[c];delete a.scripts[c]}return f||""}).replace(/\<\!-- ELRTE_COMMENT([\s\S]*?) --\>/gi,"$1").replace(this.serviceClassRegExp,function(c,o,j,u){var j=a.parseAttrs(j),f,t="";if(j["class"]["elrte-google-maps"]){var c="";if(a.scripts[j.id]){c=a.scripts[j.id];delete a.scripts[j.id]}return c}else{if(j["class"]["elrte-iframe"]){return a.scripts[j.id]||""}else{if(j["class"]["elrtebm"]){return""}else{if(j["class"]["elrte-media"]){f=a.scripts[j.rel]||{};f.params&&b.each(f.params,function(k,p){t+="<param "+a.serializeAttrs(p)+">\n"});f.embed&&(t+="<embed "+a.serializeAttrs(f.embed)+">");f.obj&&(t="<object "+a.serializeAttrs(f.obj)+">\n"+t+"\n</object>\n");return t||c}else{if(j["class"]["elrte-pagebreak"]){return"<!-- pagebreak -->"}}}}}b.each(j["class"],function(k){if(/^elrte-\w+/i.test(k)){delete (j["class"][k])}});return"<"+o+" "+a.serializeAttrs(j)+">"+(u||"")});return h},compactStyles:function(f){var a=this;return f.replace(this.tagRegExp,function(o,c,k,p){p=!c&&p?a.serializeAttrs(a.parseAttrs(p),true):"";return"<"+c+k.toLowerCase()+(p?" ":"")+p+">"})},xhtmlTags:function(a){return this.xhtml?a.replace(/<(img|hr|br|embed|param|link|area)([^>]*\/*)>/gi,"<$1$2 />"):a}};elRTE.prototype.filter.prototype.chains={wysiwyg:["replace","clean","allowedTags","deniedTags","compactStyles"],source:["clean","allowedTags","restore","compactStyles","xhtmlTags"],paste:["clean","allowedTags","cleanPaste","replace","deniedTags","compactStyles"],wysiwyg2wysiwyg:["clean","allowedTags","restore","replace","deniedTags","compactStyles"],source2source:["clean","allowedTags","replace","deniedTags","restore","compactStyles","xhtmlTags"]}})(jQuery);(function(b){elRTE.prototype.history=function(a){this.rte=a;this._prev=[];this._next=[];this.add=function(){if(this.rte.options.historyLength>0&&this._prev.length>=this.rte.options.historyLength){this._prev.slice(this.rte.options.historyLength)}var f=this.rte.selection.getBookmark();this._prev.push([b(this.rte.doc.body).html(),f]);this.rte.selection.moveToBookmark(f);this._next=[]};this.back=function(){if(this._prev.length){var h=this.rte.selection.getBookmark(),g=this._prev.pop();this._next.push([b(this.rte.doc.body).html(),h]);b(this.rte.doc.body).html(g[0]);this.rte.selection.moveToBookmark(g[1])}};this.fwd=function(){if(this._next.length){var h=this.rte.selection.getBookmark(),g=this._next.pop();this._prev.push([b(this.rte.doc.body).html(),h]);b(this.rte.doc.body).html(g[0]);this.rte.selection.moveToBookmark(g[1])}};this.canBack=function(){return this._prev.length};this.canFwd=function(){return this._next.length}}})(jQuery);(function(b){elRTE.prototype.options={doctype:'<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">',cssClass:"el-rte",cssfiles:[],height:null,resizable:true,lang:"en",toolbar:"normal",absoluteURLs:true,allowSource:true,stripWhiteSpace:true,styleWithCSS:false,fmAllow:true,fmOpen:null,allowTags:[],denyTags:["applet","base","basefont","bgsound","blink","body","col","colgroup","isindex","frameset","html","head","meta","marquee","noframes","noembed","o:p","title","xml"],denyAttr:[],pasteDenyAttr:["id","name","class","style","language","onclick","ondblclick","onhover","onkeup","onkeydown","onkeypress"],allowTextNodes:true,allowBrowsersSpecStyles:false,allowPaste:true,pasteOnlyText:false,replace:[],restore:[],pagebreak:'<div style="page-break-after: always;"></div>',buttons:{save:"Save",copy:"Copy",cut:"Cut",css:"Css style and class",paste:"Paste",pastetext:"Paste only text",pasteformattext:"Paste formatted text",removeformat:"Clean format",undo:"Undo last action",redo:"Redo previous action",bold:"Bold",italic:"Italic",underline:"Underline",strikethrough:"Strikethrough",superscript:"Superscript",subscript:"Subscript",justifyleft:"Align left",justifyright:"Ailgn right",justifycenter:"Align center",justifyfull:"Align full",indent:"Indent",outdent:"Outdent",rtl:"Right to left",ltr:"Left to right",forecolor:"Font color",hilitecolor:"Background color",formatblock:"Format",fontsize:"Font size",fontname:"Font",insertorderedlist:"Ordered list",insertunorderedlist:"Unordered list",horizontalrule:"Horizontal rule",blockquote:"Blockquote",div:"Block element (DIV)",link:"Link",unlink:"Delete link",anchor:"Bookmark",image:"Image",pagebreak:"Page break",smiley:"Smiley",flash:"Flash",table:"Table",tablerm:"Delete table",tableprops:"Table properties",tbcellprops:"Table cell properties",tbrowbefore:"Insert row before",tbrowafter:"Insert row after",tbrowrm:"Delete row",tbcolbefore:"Insert column before",tbcolafter:"Insert column after",tbcolrm:"Delete column",tbcellsmerge:"Merge table cells",tbcellsplit:"Split table cell",docstructure:"Toggle display document structure",elfinder:"Open file manager",fullscreen:"Toggle full screen mode",nbsp:"Non breakable space",stopfloat:"Stop element floating",about:"About this software"},panels:{eol:[],save:["save"],copypaste:["copy","cut","paste","pastetext","pasteformattext","removeformat","docstructure"],undoredo:["undo","redo"],style:["bold","italic","underline","strikethrough","subscript","superscript"],colors:["forecolor","hilitecolor"],alignment:["justifyleft","justifycenter","justifyright","justifyfull"],indent:["outdent","indent"],format:["formatblock","fontsize","fontname"],lists:["insertorderedlist","insertunorderedlist"],elements:["horizontalrule","blockquote","div","stopfloat","css","nbsp","smiley","pagebreak"],direction:["ltr","rtl"],links:["link","unlink","anchor"],images:["image"],media:["image","flash"],tables:["table","tableprops","tablerm","tbrowbefore","tbrowafter","tbrowrm","tbcolbefore","tbcolafter","tbcolrm","tbcellprops","tbcellsmerge","tbcellsplit"],elfinder:["elfinder"],fullscreen:["fullscreen","about"]},toolbars:{tiny:["style"],compact:["save","undoredo","style","alignment","lists","links","fullscreen"],normal:["save","copypaste","undoredo","style","alignment","colors","indent","lists","links","elements","images","fullscreen"],complete:["save","copypaste","undoredo","style","alignment","colors","format","indent","lists","links","elements","media","fullscreen"],maxi:["save","copypaste","undoredo","elfinder","style","alignment","direction","colors","format","indent","lists","links","elements","media","tables","fullscreen"],eldorado:["save","copypaste","elfinder","undoredo","style","alignment","colors","format","indent","lists","links","elements","media","tables","fullscreen"]},panelNames:{save:"Save",copypaste:"Copy/Pase",undoredo:"Undo/Redo",style:"Text styles",colors:"Colors",alignment:"Alignment",indent:"Indent/Outdent",format:"Text format",lists:"Lists",elements:"Misc elements",direction:"Script direction",links:"Links",images:"Images",media:"Media",tables:"Tables",elfinder:"File manager (elFinder)"}}})(jQuery);(function(b){elRTE.prototype.selection=function(t){this.rte=t;var w=this;this.w3cRange=null;var v,a,q,p;b(this.rte.doc).keyup(function(c){if(c.ctrlKey||c.metaKey||(c.keyCode>=8&&c.keyCode<=13)||(c.keyCode>=32&&c.keyCode<=40)||c.keyCode==46||(c.keyCode>=96&&c.keyCode<=111)){w.cleanCache()}}).mousedown(function(c){if(c.target.nodeName=="HTML"){v=w.rte.doc.body}else{v=c.target}a=q=null}).mouseup(function(c){if(c.target.nodeName=="HTML"){a=w.rte.doc.body}else{a=c.target}a=c.target;q=null}).click();function r(){return w.rte.window.getSelection?w.rte.window.getSelection():w.rte.window.document.selection}function u(c,f,g){while(c.nodeName!="BODY"&&c.parentNode&&c.parentNode.nodeName!="BODY"&&(f?c!==f&&c.parentNode!=f:1)&&((g=="left"&&w.rte.dom.isFirstNotEmpty(c))||(g=="right"&&w.rte.dom.isLastNotEmpty(c))||(w.rte.dom.isFirstNotEmpty(c)&&w.rte.dom.isLastNotEmpty(c)))){c=c.parentNode}return c}this.collapsed=function(){return this.getRangeAt().isCollapsed()};this.collapse=function(g){var f=r(),c=this.getRangeAt();c.collapse(g?true:false);if(!b.browser.msie){f.removeAllRanges();f.addRange(c)}return this};this.getRangeAt=function(c){if(this.rte.browser.msie){if(!this.w3cRange){this.w3cRange=new this.rte.w3cRange(this.rte)}c&&this.w3cRange.update();return this.w3cRange}var g=r();var f=g.rangeCount>0?g.getRangeAt(0):this.rte.doc.createRange();f.getStart=function(){return this.startContainer.nodeType==1?this.startContainer.childNodes[Math.min(this.startOffset,this.startContainer.childNodes.length-1)]:this.startContainer};f.getEnd=function(){return this.endContainer.nodeType==1?this.endContainer.childNodes[Math.min(this.startOffset==this.endOffset?this.endOffset:this.endOffset-1,this.endContainer.childNodes.length-1)]:this.endContainer};f.isCollapsed=function(){return this.collapsed};return f};this.saveIERange=function(){if(b.browser.msie){p=this.getRangeAt().getBookmark()}};this.restoreIERange=function(){b.browser.msie&&p&&this.getRangeAt().moveToBookmark(p)};this.cloneContents=function(){var c=this.rte.dom.create("div"),h,f,j;if(b.browser.msie){try{h=this.rte.window.document.selection.createRange()}catch(g){h=this.rte.doc.body.createTextRange()}b(c).html(h.htmlText)}else{f=this.getRangeAt().cloneContents();for(j=0;j<f.childNodes.length;j++){c.appendChild(f.childNodes[j].cloneNode(true))}}return c};this.select=function(h,c){c=c||h;if(this.rte.browser.msie){var g=this.rte.doc.body.createTextRange(),j=g.duplicate(),k=g.duplicate();j.moveToElementText(h);k.moveToElementText(c);g.setEndPoint("StartToStart",j);g.setEndPoint("EndToEnd",k);g.select()}else{var f=r(),g=this.getRangeAt();g.setStartBefore(h);g.setEndAfter(c);f.removeAllRanges();f.addRange(g)}return this.cleanCache()};this.selectContents=function(c){var g=this.getRangeAt();if(c&&c.nodeType==1){if(this.rte.browser.msie){g.range();g.r.moveToElementText(c.parentNode);g.r.select()}else{try{g.selectNodeContents(c)}catch(f){return this.rte.log("unable select node contents "+c)}var h=r();h.removeAllRanges();h.addRange(g)}}return this};this.deleteContents=function(){if(!b.browser.msie){this.getRangeAt().deleteContents()}return this};this.insertNode=function(c,f){if(f&&!this.collapsed()){this.collapse()}if(this.rte.browser.msie){var j=c.nodeType==3?c.nodeValue:b(this.rte.dom.create("span")).append(b(c)).html();var g=this.getRangeAt();g.insertNode(j)}else{var g=this.getRangeAt();g.insertNode(c);g.setStartAfter(c);g.setEndAfter(c);var h=r();h.removeAllRanges();h.addRange(g)}return this.cleanCache()};this.insertHtml=function(g,f){if(f&&!this.collapsed()){this.collapse()}if(this.rte.browser.msie){this.getRangeAt().range().pasteHTML(g)}else{var c=b(this.rte.dom.create("span")).html(g||"").get(0);this.insertNode(c);b(c).replaceWith(b(c).html())}return this.cleanCache()};this.insertText=function(f,g){var c=this.rte.doc.createTextNode(f);return this.insertHtml(c.nodeValue)};this.getBookmark=function(){this.rte.window.focus();var f,o,C,h,k,g=this.rte.dom.createBookmark(),j=this.rte.dom.createBookmark();if(b.browser.msie){try{f=this.rte.window.document.selection.createRange()}catch(j){f=this.rte.doc.body.createTextRange()}if(f.item){var B=f.item(0);f=this.rte.doc.body.createTextRange();f.moveToElementText(B)}o=f.duplicate();C=f.duplicate();h=this.rte.dom.create("span");k=this.rte.dom.create("span");h.appendChild(g);k.appendChild(j);o.collapse(true);o.pasteHTML(h.innerHTML);C.collapse(false);C.pasteHTML(k.innerHTML)}else{var c=r();var f=c.rangeCount>0?c.getRangeAt(0):this.rte.doc.createRange();o=f.cloneRange();C=f.cloneRange();C.collapse(false);C.insertNode(j);o.collapse(true);o.insertNode(g);this.select(g,j)}return[g.id,j.id]};this.moveToBookmark=function(j){this.rte.window.focus();if(j&&j.length==2){var h=this.rte.doc.getElementById(j[0]),c=this.rte.doc.getElementById(j[1]),f,g;if(h&&c){this.select(h,c);if(this.rte.dom.next(h)==c){this.collapse(true)}if(!b.browser.msie){f=r();g=f.rangeCount>0?f.getRangeAt(0):this.rte.doc.createRange();f.removeAllRanges();f.addRange(g)}h.parentNode.removeChild(h);c.parentNode.removeChild(c)}}return this};this.removeBookmark=function(g){this.rte.window.focus();if(g.length==2){var f=this.rte.doc.getElementById(g[0]),c=this.rte.doc.getElementById(g[1]);if(f&&c){f.parentNode.removeChild(f);c.parentNode.removeChild(c)}}};this.cleanCache=function(){v=a=q=null;return this};this.getStart=function(){if(!v){var c=this.getRangeAt();v=c.getStart()}return v};this.getEnd=function(){if(!a){var c=this.getRangeAt();a=c.getEnd()}return a};this.getNode=function(){if(!q){q=this.rte.dom.findCommonAncestor(this.getStart(),this.getEnd())}return q};this.selected=function(c){var h={collapsed:false,blocks:false,filter:false,wrap:"text",tag:"span"};h=b.extend({},h,c);if(h.blocks){var D=this.getNode(),E=null;if(E=this.rte.dom.selfOrParent(D,"selectionBlock")){return[E]}}var F=this.selectedRaw(h.collapsed,h.blocks);var j=[];var C=[];var g=null;function f(){function z(){for(var B=0;B<C.length;B++){if(C[B].nodeType==1&&(w.rte.dom.selfOrParent(C[B],/^P$/)||b(C[B]).find("p").length>0)){return false}}return true}if(C.length>0){var A=h.tag=="p"&&!z()?"div":h.tag;var x=w.rte.dom.wrap(C,A);j[g]=x;g=null;C=[]}}function k(x){if(x.nodeType==1){if(/^(THEAD|TFOOT|TBODY|COL|COLGROUP|TR)$/.test(x.nodeName)){b(x).find("td,th").each(function(){var H=h.tag=="p"&&b(this).find("p").length>0?"div":h.tag;var B=w.rte.dom.wrapContents(this,H);return j.push(B)})}else{if(/^(CAPTION|TD|TH|LI|DT|DD)$/.test(x.nodeName)){var A=h.tag=="p"&&b(x).find("p").length>0?"div":h.tag;var x=w.rte.dom.wrapContents(x,A);return j.push(x)}}}var z=C.length>0?C[C.length-1]:null;if(z&&z!=w.rte.dom.prev(x)){f()}C.push(x);if(g===null){g=j.length;j.push("dummy")}}if(F.nodes.length>0){for(var o=0;o<F.nodes.length;o++){var D=F.nodes[o];if(D.nodeType==3&&(o==0||o==F.nodes.length-1)&&b.trim(D.nodeValue).length>0){if(o==0&&F.so>0){D=D.splitText(F.so)}if(o==F.nodes.length-1&&F.eo>0){D.splitText(o==0&&F.so>0?F.eo-F.so:F.eo)}}switch(h.wrap){case"text":if((D.nodeType==1&&D.nodeName=="BR")||(D.nodeType==3&&b.trim(D.nodeValue).length>0)){k(D)}else{if(D.nodeType==1){j.push(D)}}break;case"inline":if(this.rte.dom.isInline(D)){k(D)}else{if(D.nodeType==1){j.push(D)}}break;case"all":if(D.nodeType==1||!this.rte.dom.isEmpty(D)){k(D)}break;default:if(D.nodeType==1||!this.rte.dom.isEmpty(D)){j.push(D)}}}f()}if(j.length){this.rte.window.focus();this.select(j[0],j[j.length-1])}return h.filter?this.rte.dom.filter(j,h.filter):j};this.dump=function(k,h,c,f,j){var g=this.getRangeAt();this.rte.log("commonAncestorContainer");this.rte.log(k||g.commonAncestorContainer);this.rte.log("startContainer");this.rte.log(h||g.startContainer);this.rte.log("startOffset: "+(f>=0?f:g.startOffset));this.rte.log("endContainer");this.rte.log(c||g.endContainer);this.rte.log("endOffset: "+(j>=0?j:g.endOffset))};this.selectedRaw=function(o,j){var P={so:null,eo:null,nodes:[]};var g=this.getRangeAt(true);var J=g.commonAncestorContainer;var L,Q;var c=false;var h=false;function f(x,A,z){if(x.nodeType==3){z=z>=0?z:x.nodeValue.length;return(A==0&&z==x.nodeValue.length)||b.trim(x.nodeValue).length==b.trim(x.nodeValue.substring(A,z)).length}return true}function I(x,A,z){if(x.nodeType==1){return w.rte.dom.isEmpty(x)}else{if(x.nodeType==3){return b.trim(x.nodeValue.substring(A||0,z>=0?z:x.nodeValue.length)).length==0}}return true}if(g.startContainer.nodeType==1){if(g.startOffset<g.startContainer.childNodes.length){L=g.startContainer.childNodes[g.startOffset];P.so=L.nodeType==1?null:0}else{L=g.startContainer.childNodes[g.startOffset-1];P.so=L.nodeType==1?null:L.nodeValue.length}}else{L=g.startContainer;P.so=g.startOffset}if(g.collapsed){if(o){if(j){L=u(L);if(!this.rte.dom.isEmpty(L)||(L=this.rte.dom.next(L))){P.nodes=[L]}if(this.rte.dom.isInline(L)){P.nodes=this.rte.dom.toLineStart(L).concat(P.nodes,this.rte.dom.toLineEnd(L))}if(P.nodes.length>0){P.so=P.nodes[0].nodeType==1?null:0;P.eo=P.nodes[P.nodes.length-1].nodeType==1?null:P.nodes[P.nodes.length-1].nodeValue.length}}else{if(!this.rte.dom.isEmpty(L)){P.nodes=[L]}}}return P}if(g.endContainer.nodeType==1){Q=g.endContainer.childNodes[g.endOffset-1];P.eo=Q.nodeType==1?null:Q.nodeValue.length}else{Q=g.endContainer;P.eo=g.endOffset}if(L.nodeType==1||j||f(L,P.so,L.nodeValue.length)){L=u(L,J,"left");c=true;P.so=L.nodeType==1?null:0}if(Q.nodeType==1||j||f(Q,0,P.eo)){Q=u(Q,J,"right");h=true;P.eo=Q.nodeType==1?null:Q.nodeValue.length}if(j){if(L.nodeType!=1&&L.parentNode!=J&&L.parentNode.nodeName!="BODY"){L=L.parentNode;P.so=null}if(Q.nodeType!=1&&Q.parentNode!=J&&Q.parentNode.nodeName!="BODY"){Q=Q.parentNode;P.eo=null}}if(L.parentNode==Q.parentNode&&L.parentNode.nodeName!="BODY"&&(c&&this.rte.dom.isFirstNotEmpty(L))&&(h&&this.rte.dom.isLastNotEmpty(Q))){L=Q=L.parentNode;P.so=L.nodeType==1?null:0;P.eo=Q.nodeType==1?null:Q.nodeValue.length}if(L==Q){if(!this.rte.dom.isEmpty(L)){P.nodes.push(L)}return P}var O=L;while(O.nodeName!="BODY"&&O.parentNode!==J&&O.parentNode.nodeName!="BODY"){O=O.parentNode}var N=Q;while(N.nodeName!="BODY"&&N.parentNode!==J&&N.parentNode.nodeName!="BODY"){N=N.parentNode}if(!I(L,P.so,L.nodeType==3?L.nodeValue.length:null)){P.nodes.push(L)}var K=L;while(K!==O){var M=K;while((M=this.rte.dom.next(M))){P.nodes.push(M)}K=K.parentNode}K=O;while((K=this.rte.dom.next(K))&&K!=N){P.nodes.push(K)}var k=[];K=Q;while(K!==N){var M=K;while((M=this.rte.dom.prev(M))){k.push(M)}K=K.parentNode}if(k.length){P.nodes=P.nodes.concat(k.reverse())}if(!I(Q,0,Q.nodeType==3?P.eo:null)){P.nodes.push(Q)}if(j){if(this.rte.dom.isInline(L)){P.nodes=this.rte.dom.toLineStart(L).concat(P.nodes);P.so=P.nodes[0].nodeType==1?null:0}if(this.rte.dom.isInline(Q)){P.nodes=P.nodes.concat(this.rte.dom.toLineEnd(Q));P.eo=P.nodes[P.nodes.length-1].nodeType==1?null:P.nodes[P.nodes.length-1].nodeValue.length}}return P}}})(jQuery);(function(b){elRTE.prototype.ui=function(B){this.rte=B;this._buttons=[];var C=this,p=this.rte.options.toolbars[B.options.toolbar&&B.options.toolbars[B.options.toolbar]?B.options.toolbar:"normal"],a=p.length,A,w,x,z,E,D,c;for(c in this.buttons){if(this.buttons.hasOwnProperty(c)&&c!="button"){this.buttons[c].prototype=this.buttons.button.prototype}}while(a--){first=(a==0?true:false);if(p[a-1]=="eol"){first=true}w=p[a];if(w=="eol"){b(this.rte.doc.createElement("br")).prependTo(this.rte.toolbar);continue}A=b('<ul class="panel-'+w+(first?" first":"")+'" />').prependTo(this.rte.toolbar);A.bind("mousedown",function(f){f.preventDefault()});x=this.rte.options.panels[w].length;while(x--){z=this.rte.options.panels[w][x];E=this.buttons[z]||this.buttons.button;this._buttons.push((D=new E(this.rte,z)));A.prepend(D.domElem)}}this.update();this.disable=function(){b.each(C._buttons,function(){!this.active&&this.domElem.addClass("disabled")})}};elRTE.prototype.ui.prototype.update=function(u){u&&this.rte.selection.cleanCache();var w=this.rte.selection.getNode(),x=this.rte.dom.parents(w,"*"),t=this.rte.rtl,a=t?" &laquo; ":" &raquo; ",p="",z,v;function r(c){var f=c.nodeName.toLowerCase();c=b(c);if(f=="img"){if(c.hasClass("elrte-media")){f="media"}else{if(c.hasClass("elrte-google-maps")){f="google map"}else{if(c.hasClass("elrte-yandex-maps")){f="yandex map"}else{if(c.hasClass("elrte-pagebreak")){f="pagebreak"}}}}}return f}if(w&&w.nodeType==1&&w.nodeName!="BODY"){x.unshift(w)}if(!t){x=x.reverse()}for(v=0;v<x.length;v++){p+=(v>0?a:"")+r(x[v])}this.rte.statusbar.html(p);b.each(this._buttons,function(){this.update()});this.rte.window.focus()};elRTE.prototype.ui.prototype.buttons={button:function(g,h){var a=this;this.rte=g;this.active=false;this.name=h;this.val=null;this.domElem=b('<li style="-moz-user-select:-moz-none" class="'+h+' rounded-3" name="'+h+'" title="'+this.rte.i18n(this.rte.options.buttons[h]||h)+'" unselectable="on" />').hover(function(){b(this).addClass("hover")},function(){b(this).removeClass("hover")}).click(function(c){c.stopPropagation();c.preventDefault();if(!b(this).hasClass("disabled")){a.command()}a.rte.window.focus()})}};elRTE.prototype.ui.prototype.buttons.button.prototype.command=function(){this.rte.history.add();try{this.rte.doc.execCommand(this.name,false,this.val)}catch(a){return this.rte.log("commands failed: "+this.name)}this.rte.ui.update(true)};elRTE.prototype.ui.prototype.buttons.button.prototype.update=function(){try{if(!this.rte.doc.queryCommandEnabled(this.name)){return this.domElem.addClass("disabled")}else{this.domElem.removeClass("disabled")}}catch(a){return}try{if(this.rte.doc.queryCommandState(this.name)){this.domElem.addClass("active")}else{this.domElem.removeClass("active")}}catch(a){}}})(jQuery);(function(b){elRTE.prototype.utils=function(f){this.rte=f;this.url=null;this.reg=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/;this.baseURL="";this.path="";this.entities={"&":"&amp;",'"':"&quot;","<":"&lt;",">":"&gt;"};this.entitiesRegExp=/[<>&\"]/g;this.media=[{type:"application/x-shockwave-flash",classid:["clsid:d27cdb6e-ae6d-11cf-96b8-444553540000"],codebase:"http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,40,0"},{type:"application/x-director",classid:["clsid:166b1bca-3f9c-11cf-8075-444553540000"],codebase:"http://download.macromedia.com/pub/shockwave/cabs/director/sw.cab#version=8,5,1,0"},{type:"application/x-mplayer2",classid:["clsid:6bf52a52-394a-11d3-b153-00c04f79faa6","clsid:22d6f312-b0f6-11d0-94ab-0080c74c7e95","clsid:05589fa1-c356-11ce-bf01-00aa0055595a"],codebase:"http://activex.microsoft.com/activex/controls/mplayer/en/nsmp2inf.cab#Version=5,1,52,701"},{type:"video/quicktime",classid:["clsid:02bf25d5-8c17-4b23-bc80-d3488abddc6b"],codebase:"http://www.apple.com/qtactivex/qtplugin.cab#version=6,0,2,0"},{type:"audio/x-pn-realaudio-plugin",classid:["clsid:cfcdaa03-8be4-11cf-b84b-0020afbbccfa"],codebase:"http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,40,0"}];this.rgbRegExp=/\s*rgb\s*?\(\s*?([0-9]+)\s*?,\s*?([0-9]+)\s*?,\s*?([0-9]+)\s*?\)\s*/i;this.colorsRegExp=/aqua|black|blue|fuchsia|gray|green|lime|maroon|navy|olive|orange|purple|red|silver|teal|white|yellow|rgb\s*\([^\)]+\)/i;this.colors={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",orange:"#ffa500",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#fffffff",yellow:"#ffff00"};var a=this;this.rgb2hex=function(c){return this.color2Hex(""+c)};this.toPixels=function(j){var k=j.match(/([0-9]+\.?[0-9]*)\s*(px|pt|em|%)/);if(k){j=k[1];unit=k[2]}if(j[0]=="."){j="0"+j}j=parseFloat(j);if(isNaN(j)){return""}var c=parseInt(b(document.body).css("font-size"))||16;switch(unit){case"em":return parseInt(j*c);case"pt":return parseInt(j*c/12);case"%":return parseInt(j*c/100)}return j};this.absoluteURL=function(c){!this.url&&this._url();c=b.trim(c);if(!c){return""}if(c[0]=="#"){return c}var h=this.parseURL(c);if(!h.host&&!h.path&&!h.anchor){return""}if(!this.rte.options.absoluteURLs){return c}if(h.protocol){return c}if(h.host&&(h.host.indexOf(".")!=-1||h.host=="localhost")){return this.url.protocol+"://"+c}if(c[0]=="/"){c=this.baseURL+c}else{if(c.indexOf("./")==0){c=c.substring(2)}c=this.baseURL+this.path+c}return c};this.parseURL=function(c){var j=c.match(this.reg);var k={};b.each(["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],function(g){k[this]=j[g]});if(!k.host.match(/[a-z0-9]/i)){k.host=""}return k};this.trimEventCallback=function(c){c=c?c.toString():"";return b.trim(c.replace(/\r*\n/mg,"").replace(/^function\s*on[a-z]+\s*\(\s*event\s*\)\s*\{(.+)\}$/igm,"$1"))};this._url=function(){this.url=this.parseURL(window.location.href);this.baseURL=this.url.protocol+"://"+(this.url.userInfo?parts.userInfo+"@":"")+this.url.host+(this.url.port?":"+this.url.port:"");this.path=!this.url.file?this.url.path:this.url.path.substring(0,this.url.path.length-this.url.file.length)};this.makeObject=function(c){var h={};b.each(c,function(k,g){h[g]=g});return h};this.encode=function(h){var c=this.entities;return(""+h).replace(this.entitiesRegExp,function(g){return c[g]})};this.decode=function(c){return b("<div/>").html(c||"").text()};this.parseStyle=function(c){var r={},v=this.rte.options.allowBrowsersSpecStyles,p,u,t,w;if(typeof(c)=="string"&&c.length){b.each(c.replace(/&quot;/gi,"'").split(";"),function(h,g){if((w=g.indexOf(":"))!==-1){u=b.trim(g.substr(0,w));t=b.trim(g.substr(w+1));if(u=="color"||u=="background-color"){t=t.toLowerCase()}if(u&&t&&(v||u.substring(0,1)!="-")){r[u]=t}}})}return r};this.compactStyle=function(c){var h=this;if(c.border=="medium none"){delete c.border}b.each(c,function(g,k){if(/color$/i.test(g)){c[g]=h.color2Hex(k)}else{if(/^(border|background)$/i.test(g)){c[g]=k.replace(h.colorsRegExp,function(j){return h.color2Hex(j)})}}});if(c["border-width"]){c.border=c["border-width"]+" "+(c["border-style"]||"solid")+" "+(c["border-color"]||"#000");delete c["border-width"];delete c["border-style"];delete c["border-color"]}if(c["background-image"]){c.background=(c["background-color"]+" ")||""+c["background-image"]+" "+c["background-position"]||"0 0 "+c["background-repeat"]||"repeat";delete c["background-image"];delete ["background-image"];delete ["background-position"];delete ["background-repeat"]}if(c["margin-top"]&&c["margin-right"]&&c["margin-bottom"]&&c["margin-left"]){c.margin=c["margin-top"]+" "+c["margin-right"]+" "+c["margin-bottom"]+" "+c["margin-left"];delete c["margin-top"];delete c["margin-right"];delete c["margin-bottom"];delete c["margin-left"]}if(c["padding-top"]&&c["padding-right"]&&c["padding-bottom"]&&c["padding-left"]){c.padding=c["padding-top"]+" "+c["padding-right"]+" "+c["padding-bottom"]+" "+c["padding-left"];delete c["padding-top"];delete c["padding-right"];delete c["padding-bottom"];delete c["padding-left"]}if(c["list-style-type"]||c["list-style-position"]||c["list-style-image"]){c["list-style"]=b.trim(c["list-style-type"]||" "+c["list-style-position"]||""+c["list-style-image"]||"");delete c["list-style-type"];delete c["list-style-position"];delete c["list-style-image"]}return c};this.serializeStyle=function(j,c){var k=[];b.each(c?this.compactStyle(j):j,function(g,h){h&&k.push(g+":"+h)});return k.join(";")};this.parseClass=function(c){c=b.trim(c);return c.length?this.makeObject(c.split(/\s+/)):{};return c.length?c.split(/\s+/):[]};this.serializeClass=function(c){var j=[];var k=this.rte;b.each(c,function(g){j.push(g)});return j.join(" ")};this.mediaInfo=function(j,c){var k=this.media.length;while(k--){if(j===this.media[k].type||(c&&b.inArray(c,this.media[k].classid)!=-1)){return this.media[k]}}};this.color2Hex=function(c){var k;c=c||"";if(c.indexOf("#")===0){return c}function j(g){g=parseInt(g).toString(16);return g.length>1?g:"0"+g}if(this.colors[c]){return this.colors[c]}if((k=c.match(this.rgbRegExp))){return"#"+j(k[1])+j(k[2])+j(k[3])}return""}}})(jQuery);(function(b){elRTE.prototype.w3cRange=function(f){var a=this;this.rte=f;this.r=null;this.collapsed=true;this.startContainer=null;this.endContainer=null;this.startOffset=0;this.endOffset=0;this.commonAncestorContainer=null;this.range=function(){try{this.r=this.rte.window.document.selection.createRange()}catch(c){this.r=this.rte.doc.body.createTextRange()}return this.r};this.insertNode=function(h){this.range();a.r.collapse(false);var c=a.r.duplicate();c.pasteHTML(h)};this.getBookmark=function(){this.range();if(this.r.item){var c=this.r.item(0);this.r=this.rte.doc.body.createTextRange();this.r.moveToElementText(c)}return this.r.getBookmark()};this.moveToBookmark=function(c){this.rte.window.focus();this.range().moveToBookmark(c);this.r.select()};this.update=function(){function k(g){var r="\uFEFF";var C=offset=0;var A=a.r.duplicate();A.collapse(g);var z=A.parentElement();if(!z||z.nodeName=="HTML"){return{parent:a.rte.doc.body,ndx:C,offset:offset}}A.pasteHTML(r);childs=z.childNodes;for(var B=0;B<childs.length;B++){var h=childs[B];if(B>0&&(h.nodeType!==3||childs[B-1].nodeType!==3)){C++}if(h.nodeType!==3){offset=0}else{var j=h.nodeValue.indexOf(r);if(j!==-1){offset+=j;break}offset+=h.nodeValue.length}}A.moveStart("character",-1);A.text="";return{parent:z,ndx:Math.min(C,z.childNodes.length-1),offset:offset}}this.range();this.startContainer=this.endContainer=null;if(this.r.item){this.collapsed=false;var o=this.r.item(0);this.setStart(o.parentNode,this.rte.dom.indexOf(o));this.setEnd(o.parentNode,this.startOffset+1)}else{this.collapsed=this.r.boundingWidth==0;var c=k(true);var p=k(false);c.parent.normalize();p.parent.normalize();c.ndx=Math.min(c.ndx,c.parent.childNodes.length-1);p.ndx=Math.min(p.ndx,p.parent.childNodes.length-1);if(c.parent.childNodes[c.ndx].nodeType&&c.parent.childNodes[c.ndx].nodeType==1){this.setStart(c.parent,c.ndx)}else{this.setStart(c.parent.childNodes[c.ndx],c.offset)}if(p.parent.childNodes[p.ndx].nodeType&&p.parent.childNodes[p.ndx].nodeType==1){this.setEnd(p.parent,p.ndx)}else{this.setEnd(p.parent.childNodes[p.ndx],p.offset)}this.select()}return this};this.isCollapsed=function(){this.range();this.collapsed=this.r.item?false:this.r.boundingWidth==0;return this.collapsed};this.collapse=function(h){this.range();if(this.r.item){var c=this.r.item(0);this.r=this.rte.doc.body.createTextRange();this.r.moveToElementText(c)}this.r.collapse(h);this.r.select();this.collapsed=true};this.getStart=function(){this.range();if(this.r.item){return this.r.item(0)}var c=this.r.duplicate();c.collapse(true);var h=c.parentElement();return h&&h.nodeName=="BODY"?h.firstChild:h};this.getEnd=function(){this.range();if(this.r.item){return this.r.item(0)}var h=this.r.duplicate();h.collapse(false);var c=h.parentElement();return c&&c.nodeName=="BODY"?c.lastChild:c};this.setStart=function(h,c){this.startContainer=h;this.startOffset=c;if(this.endContainer){this.commonAncestorContainer=this.rte.dom.findCommonAncestor(this.startContainer,this.endContainer)}};this.setEnd=function(h,c){this.endContainer=h;this.endOffset=c;if(this.startContainer){this.commonAncestorContainer=this.rte.dom.findCommonAncestor(this.startContainer,this.endContainer)}};this.setStartBefore=function(c){if(c.parentNode){this.setStart(c.parentNode,this.rte.dom.indexOf(c))}};this.setStartAfter=function(c){if(c.parentNode){this.setStart(c.parentNode,this.rte.dom.indexOf(c)+1)}};this.setEndBefore=function(c){if(c.parentNode){this.setEnd(c.parentNode,this.rte.dom.indexOf(c))}};this.setEndAfter=function(c){if(c.parentNode){this.setEnd(c.parentNode,this.rte.dom.indexOf(c)+1)}};this.select=function(){function p(q,o){if(q.nodeType!=3){return -1}var h="\uFEFF";var g=q.nodeValue;var k=a.rte.doc.body.createTextRange();q.nodeValue=g.substring(0,o)+h+g.substring(o);k.moveToElementText(q.parentNode);k.findText(h);var j=Math.abs(k.moveStart("character",-1048575));q.nodeValue=g;return j}this.r=this.rte.doc.body.createTextRange();var r=this.startOffset;var x=this.endOffset;var A=this.startContainer.nodeType==1?this.startContainer.childNodes[Math.min(r,this.startContainer.childNodes.length-1)]:this.startContainer;var c=this.endContainer.nodeType==1?this.endContainer.childNodes[Math.min(r==x?x:x-1,this.endContainer.childNodes.length-1)]:this.endContainer;if(this.collapsed){if(A.nodeType==3){var w=p(A,r);this.r.move("character",w)}else{this.r.moveToElementText(A);this.r.collapse(true)}}else{var z=this.rte.doc.body.createTextRange();var v=p(A,r);var B=p(c,x);if(A.nodeType==3){this.r.move("character",v)}else{this.r.moveToElementText(A)}if(c.nodeType==3){z.move("character",B)}else{z.moveToElementText(c)}this.r.setEndPoint("EndToEnd",z)}try{this.r.select()}catch(c){}if(z){z=null}};this.dump=function(){this.rte.log("collapsed: "+this.collapsed);this.rte.log("startContainer: "+(this.startContainer?this.startContainer.nodeName:"non"));this.rte.log("startOffset: "+this.startOffset);this.rte.log("endContainer: "+(this.endContainer?this.endContainer.nodeName:"none"));this.rte.log("endOffset: "+this.endOffset)}}})(jQuery);(function(b){elRTE.prototype.ui.prototype.buttons.about=function(f,a){this.constructor.prototype.constructor.call(this,f,a);this.active=true;this.command=function(){var j,c,k;j={rtl:f.rtl,submit:function(h,g){g.close()},dialog:{width:560,title:this.rte.i18n("About this software"),buttons:{Ok:function(){b(this).dialog("destroy")}}}};k='<div class="elrte-logo"></div><h3>'+this.rte.i18n("About elRTE")+'</h3><br clear="all"/><div class="elrte-ver">'+this.rte.i18n("Version")+": "+this.rte.version+" ("+this.rte.build+')</div><div class="elrte-ver">jQuery: '+b("<div/>").jquery+'</div><div class="elrte-ver">jQueryUI: '+b.ui.version+'</div><div class="elrte-ver">'+this.rte.i18n("Licence")+": BSD Licence</div><p>"+this.rte.i18n("elRTE is an open-source JavaScript based WYSIWYG HTML-editor.")+"<br/>"+this.rte.i18n("Main goal of the editor - simplify work with text and formating (HTML) on sites, blogs, forums and other online services.")+"<br/>"+this.rte.i18n("You can use it in any commercial or non-commercial projects.")+"</p><h4>"+this.rte.i18n("Authors")+'</h4><table class="elrte-authors"><tr><td>Dmitry (dio) Levashov &lt;dio@std42.ru&gt;</td><td>'+this.rte.i18n("Chief developer")+"</td></tr><tr><td>Troex Nevelin &lt;troex@fury.scancode.ru&gt;</td><td>"+this.rte.i18n("Developer, tech support")+"</td></tr><tr><td>Valentin Razumnyh &lt;content@std42.ru&gt;</td><td>"+this.rte.i18n("Interface designer")+"</td></tr><tr><td>Tawfek Daghistani &lt;tawfekov@gmail.com&gt;</td><td>"+this.rte.i18n("RTL support")+"</td></tr>"+(this.rte.options.lang!="en"?"<tr><td>"+this.rte.i18n("_translator")+"</td><td>"+this.rte.i18n("_translation")+"</td></tr>":"")+'</table><div class="elrte-copy">Copyright &copy; 2009-2011, <a href="http://www.std42.ru">Studio 42</a></div><div class="elrte-copy">'+this.rte.i18n("For more information about this software visit the")+' <a href="http://elrte.org">'+this.rte.i18n("elRTE website")+'.</a></div><div class="elrte-copy">Twitter: <a href="http://twitter.com/elrte_elfinder">elrte_elfinder</a></div>';c=new elDialogForm(j);c.append(k);c.open()};this.update=function(){this.domElem.removeClass("disabled")}}})(jQuery);(function(b){elRTE.prototype.ui.prototype.buttons.anchor=function(g,h){this.constructor.prototype.constructor.call(this,g,h);this.input=b('<input type="text" />').attr("name","anchor").attr("size","16");var a=this;this.command=function(){var f={rtl:this.rte.rtl,submit:function(p,o){p.stopPropagation();p.preventDefault();o.close();a.set()},dialog:{title:this.rte.i18n("Bookmark")}};this.anchor=this.rte.dom.selfOrParentAnchor(this.rte.selection.getEnd())||g.dom.create("a");!this.rte.selection.collapsed()&&this.rte.selection.collapse(false);this.input.val(b(this.anchor).addClass("elrte-anchor").attr("name"));this.rte.selection.saveIERange();var c=new elDialogForm(f);c.append([this.rte.i18n("Bookmark name"),this.input],null,true).open();setTimeout(function(){a.input.focus()},20)};this.update=function(){var c=this.rte.selection.getNode();if(this.rte.dom.selfOrParentLink(c)){this.domElem.addClass("disabled")}else{if(this.rte.dom.selfOrParentAnchor(c)){this.domElem.removeClass("disabled").addClass("active")}else{this.domElem.removeClass("disabled").removeClass("active")}}};this.set=function(){var c=b.trim(this.input.val());if(c){this.rte.history.add();if(!this.anchor.parentNode){this.rte.selection.insertHtml('<a name="'+c+'" title="'+this.rte.i18n("Bookmark")+": "+c+'" class="elrte-anchor"></a>')}else{this.anchor.name=c;this.anchor.title=this.rte.i18n("Bookmark")+": "+c}}else{if(this.anchor.parentNode){this.rte.history.add();this.anchor.parentNode.removeChild(this.anchor)}}}}})(jQuery);(function(b){elRTE.prototype.ui.prototype.buttons.blockquote=function(f,a){this.constructor.prototype.constructor.call(this,f,a);this.command=function(){var c,h;this.rte.history.add();if(this.rte.selection.collapsed()&&(c=this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^BLOCKQUOTE$/))){b(c).replaceWith(b(c).html())}else{h=this.rte.selection.selected({wrap:"all",tag:"blockquote"});h.length&&this.rte.selection.select(h[0],h[h.length-1])}this.rte.ui.update(true)};this.update=function(){if(this.rte.selection.collapsed()){if(this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^BLOCKQUOTE$/)){this.domElem.removeClass("disabled").addClass("active")}else{this.domElem.addClass("disabled").removeClass("active")}}else{this.domElem.removeClass("disabled active")}}}})(jQuery);(function(b){elRTE.prototype.ui.prototype.buttons.copy=function(f,a){this.constructor.prototype.constructor.call(this,f,a);this.command=function(){if(this.rte.browser.mozilla){try{this.rte.doc.execCommand(this.name,false,null)}catch(k){var p=" Ctl + C";if(this.name=="cut"){p=" Ctl + X"}else{if(this.name=="paste"){p=" Ctl + V"}}var o={dialog:{title:this.rte.i18n("Warning"),buttons:{Ok:function(){b(this).dialog("close")}}}};var c=new elDialogForm(o);c.append(this.rte.i18n("This operation is disabled in your browser on security reason. Use shortcut instead.")+": "+p).open()}}else{this.constructor.prototype.command.call(this)}}};elRTE.prototype.ui.prototype.buttons.cut=elRTE.prototype.ui.prototype.buttons.copy;elRTE.prototype.ui.prototype.buttons.paste=elRTE.prototype.ui.prototype.buttons.copy})(jQuery);(function(b){elRTE.prototype.ui.prototype.buttons.css=function(g,h){var a=this;this.constructor.prototype.constructor.call(this,g,h);this.cssStyle=b('<input type="text" size="42" name="style" />');this.cssClass=b('<input type="text" size="42" name="class" />');this.elementID=b('<input type="text" size="42" name="id" />');this.command=function(){var c=this.node(),k;this.rte.selection.saveIERange();if(c){var k={submit:function(j,p){j.stopPropagation();j.preventDefault();p.close();a.set()},dialog:{title:this.rte.i18n("Style"),width:450,resizable:true,modal:true}};this.cssStyle.val(b(c).attr("style"));this.cssClass.val(b(c).attr("class"));this.elementID.val(b(c).attr("id"));var f=new elDialogForm(k);f.append([this.rte.i18n("Css style"),this.cssStyle],null,true);f.append([this.rte.i18n("Css class"),this.cssClass],null,true);f.append([this.rte.i18n("ID"),this.elementID],null,true);f.open();setTimeout(function(){a.cssStyle.focus()},20)}};this.set=function(){var c=this.node();this.rte.selection.restoreIERange();if(c){b(c).attr("style",this.cssStyle.val());b(c).attr("class",this.cssClass.val());b(c).attr("id",this.elementID.val());this.rte.ui.update()}};this.node=function(){var c=this.rte.selection.getNode();if(c.nodeType==3){c=c.parentNode}return c.nodeType==1&&c.nodeName!="BODY"?c:null};this.update=function(){this.domElem.toggleClass("disabled",this.node()?false:true)}}})(jQuery);(function(b){elRTE.prototype.ui.prototype.buttons.rtl=function(g,h){this.constructor.prototype.constructor.call(this,g,h);var a=this;this.command=function(){var c=this.rte.selection.getNode(),f=this;if(b(c).attr("dir")=="rtl"||b(c).parents('[dir="rtl"]').length||b(c).find('[dir="rtl"]').length){b(c).removeAttr("dir");b(c).parents('[dir="rtl"]').removeAttr("dir");b(c).find('[dir="rtl"]').removeAttr("dir")}else{if(this.rte.dom.is(c,"textNodes")&&this.rte.dom.is(c,"block")){b(c).attr("dir","rtl")}else{b.each(this.rte.dom.parents(c,"textNodes"),function(p,o){if(f.rte.dom.is(o,"block")){b(o).attr("dir","rtl");return false}})}}this.rte.ui.update()};this.update=function(){var c=this.rte.selection.getNode();this.domElem.removeClass("disabled");if(b(c).attr("dir")=="rtl"||b(c).parents('[dir="rtl"]').length||b(c).find('[dir="rtl"]').length){this.domElem.addClass("active")}else{this.domElem.removeClass("active")}}};elRTE.prototype.ui.prototype.buttons.ltr=function(g,h){this.constructor.prototype.constructor.call(this,g,h);var a=this;this.command=function(){var c=this.rte.selection.getNode(),f=this;if(b(c).attr("dir")=="ltr"||b(c).parents('[dir="ltr"]').length||b(c).find('[dir="ltr"]').length){b(c).removeAttr("dir");b(c).parents('[dir="ltr"]').removeAttr("dir");b(c).find('[dir="ltr"]').removeAttr("dir")}else{if(this.rte.dom.is(c,"textNodes")&&this.rte.dom.is(c,"block")){b(c).attr("dir","ltr")}else{b.each(this.rte.dom.parents(c,"textNodes"),function(p,o){if(f.rte.dom.is(o,"block")){b(o).attr("dir","ltr");return false}})}}this.rte.ui.update()};this.update=function(){var c=this.rte.selection.getNode();this.domElem.removeClass("disabled");if(b(c).attr("dir")=="ltr"||b(c).parents('[dir="ltr"]').length||b(c).find('[dir="ltr"]').length){this.domElem.addClass("active")}else{this.domElem.removeClass("active")}}}})(jQuery);(function(b){elRTE.prototype.ui.prototype.buttons.div=function(f,a){this.constructor.prototype.constructor.call(this,f,a);this.command=function(){var c,h;this.rte.history.add();if(this.rte.selection.collapsed()){c=this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^DIV$/);if(c){b(c).replaceWith(b(c).html())}}else{h=this.rte.selection.selected({wrap:"all",tag:"div"});h.length&&this.rte.selection.select(h[0],h[h.length-1])}this.rte.ui.update(true)};this.update=function(){if(this.rte.selection.collapsed()){if(this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^DIV$/)){this.domElem.removeClass("disabled").addClass("active")}else{this.domElem.addClass("disabled active")}}else{this.domElem.removeClass("disabled active")}}}})(jQuery);(function(b){elRTE.prototype.ui.prototype.buttons.docstructure=function(f,a){this.constructor.prototype.constructor.call(this,f,a);this.command=function(){this.domElem.toggleClass("active");b(this.rte.doc.body).toggleClass("el-rte-structure")};this.command();this.update=function(){this.domElem.removeClass("disabled")}}})(jQuery);(function(b){elRTE.prototype.ui.prototype.buttons.elfinder=function(g,h){this.constructor.prototype.constructor.call(this,g,h);var a=this,g=this.rte;this.command=function(){if(a.rte.options.fmAllow&&typeof(a.rte.options.fmOpen)=="function"){a.rte.options.fmOpen(function(c){var f=decodeURIComponent(c.split("/").pop().replace(/\+/g," "));if(g.selection.collapsed()){g.selection.insertHtml('<a href="'+c+'" >'+f+"</a>")}else{g.doc.execCommand("createLink",false,c)}})}};this.update=function(){if(a.rte.options.fmAllow&&typeof(a.rte.options.fmOpen)=="function"){this.domElem.removeClass("disabled")}else{this.domElem.addClass("disabled")}}}})(jQuery);(function(b){elRTE.prototype.ui.prototype.buttons.flash=function(g,h){this.constructor.prototype.constructor.call(this,g,h);var a=this;this.swf=null;this.placeholder=null;this.src={url:b('<input type="text" name="url" />').css("width","99%"),type:b('<select name="type"/>').append('<option value="application/x-shockwave-flash">Flash</option>').append('<option value="video/quicktime">Quicktime movie</option>').append('<option value="application/x-mplayer2">Windows media</option>'),width:b('<input type="text" />').attr("size",5).css("text-align","right"),height:b('<input type="text" />').attr("size",5).css("text-align","right"),wmode:b("<select />").append(b("<option />").val("").text(this.rte.i18n("Not set","dialogs"))).append(b("<option />").val("transparent").text(this.rte.i18n("Transparent"))),align:b("<select />").append(b("<option />").val("").text(this.rte.i18n("Not set","dialogs"))).append(b("<option />").val("left").text(this.rte.i18n("Left"))).append(b("<option />").val("right").text(this.rte.i18n("Right"))).append(b("<option />").val("top").text(this.rte.i18n("Top"))).append(b("<option />").val("text-top").text(this.rte.i18n("Text top"))).append(b("<option />").val("middle").text(this.rte.i18n("middle"))).append(b("<option />").val("baseline").text(this.rte.i18n("Baseline"))).append(b("<option />").val("bottom").text(this.rte.i18n("Bottom"))).append(b("<option />").val("text-bottom").text(this.rte.i18n("Text bottom"))),margin:b("<div />")};this.command=function(){var c=this.rte.selection.getEnd(),G,F="",D="",M="",K,I,J,E,o,f;this.rte.selection.saveIERange();this.src.margin.elPaddingInput({type:"margin"});this.placeholder=null;this.swf=null;if(b(c).hasClass("elrte-media")&&(E=b(c).attr("rel"))&&this.rte.filter.scripts[E]){this.placeholder=b(c);o=this.rte.filter.scripts[E];F="";if(o.embed&&o.embed.src){F=o.embed.src}if(o.params&&o.params.length){l=o.params.length;while(l--){if(o.params[l].name=="src"||o.params[l].name=="movie"){F=o.params[l].value}}}if(o.embed){D=o.embed.width||parseInt(o.embed.style.width)||"";M=o.embed.height||parseInt(o.embed.style.height)||"";f=o.embed.wmode||""}else{if(o.obj){D=o.obj.width||parseInt(o.obj.style.width)||"";M=o.obj.height||parseInt(o.obj.style.height)||"";f=o.obj.wmode||""}}if(o.obj){K=o.obj.style["float"]||"";I=o.obj.style["vertical-align"]||""}else{if(o.embed){K=o.embed.style["float"]||"";I=o.embed.style["vertical-align"]||""}}this.src.margin.val(c);this.src.type.val(o.embed?o.embed.type:"")}if(b(c).hasClass("elrte-swf-placeholder")){this.placeholder=b(c);F=b(c).attr("rel");D=parseInt(b(c).css("width"))||"";M=parseInt(b(c).css("height"))||"";K=b(c).css("float");I=b(c).css("vertical-align");this.src.margin.val(c);this.src.wmode.val(b(c).attr("wmode"))}this.src.url.val(F);this.src.width.val(D);this.src.height.val(M);this.src.align.val(K||I);this.src.wmode.val(f);var G={rtl:this.rte.rtl,submit:function(j,k){j.stopPropagation();j.preventDefault();a.set();k.close()},dialog:{width:580,position:"top",title:this.rte.i18n("Flash")}};var J=new elDialogForm(G);if(this.rte.options.fmAllow&&this.rte.options.fmOpen){var H=b("<span />").append(this.src.url.css("width","85%")).append(b("<span />").addClass("ui-state-default ui-corner-all").css({"float":"right","margin-right":"3px"}).attr("title",a.rte.i18n("Open file manger")).append(b("<span />").addClass("ui-icon ui-icon-folder-open")).click(function(){a.rte.options.fmOpen(function(j){a.src.url.val(j).change()})}).hover(function(){b(this).addClass("ui-state-hover")},function(){b(this).removeClass("ui-state-hover")}))}else{var H=this.src.url}J.append([this.rte.i18n("URL"),H],null,true);J.append([this.rte.i18n("Type"),this.src.type],null,true);J.append([this.rte.i18n("Size"),b("<span />").append(this.src.width).append(" x ").append(this.src.height).append(" px")],null,true);J.append([this.rte.i18n("Wmode"),this.src.wmode],null,true);J.append([this.rte.i18n("Alignment"),this.src.align],null,true);J.append([this.rte.i18n("Margins"),this.src.margin],null,true);J.open();var L=b("<fieldset />").append(b("<legend />").text(this.rte.i18n("Preview")));J.append(L,"main");var w=document.createElement("iframe");b(w).attr("src","#").addClass("el-rte-preview").appendTo(L);html=this.rte.options.doctype+'<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /></head><body style="padding:0;margin:0;font-size:9px"> Proin elit arcu, rutrum commodo, vehicula tempus, commodo a, risus. Curabitur nec arcu. Donec sollicitudin mi sit amet mauris. Nam elementum quam ullamcorper ante. Etiam aliquet massa et lorem. Mauris dapibus lacus auctor risus. Aenean tempor ullamcorper leo. Vivamus sed magna quis ligula eleifend adipiscing. Duis orci. Aliquam sodales tortor vitae ipsum. Aliquam nulla. Duis aliquam molestie erat. Ut et mauris vel pede varius sollicitudin</body></html>';w.contentWindow.document.open();w.contentWindow.document.write(html);w.contentWindow.document.close();this.frame=w.contentWindow.document;this.preview=b(w.contentWindow.document.body);this.src.type.change(function(){a.src.url.change()});this.src.width.change(function(){if(a.swf){var j=parseInt(b(this).val())||"";b(this).val(j);a.swf.css("width",j);a.swf.children("embed").css("width",j)}else{b(this).val("")}});this.src.height.change(function(){if(a.swf){var j=parseInt(b(this).val())||"";b(this).val(j);a.swf.css("height",j);a.swf.children("embed").css("height",j)}else{b(this).val("")}});this.src.wmode.change(function(){if(a.swf){var j=b(this).val();if(j){a.swf.attr("wmode",j);a.swf.children("embed").attr("wmode",j)}else{a.swf.removeAttr("wmode");a.swf.children("embed").removeAttr("wmode")}}});this.src.align.change(function(){var j=b(this).val(),k=j=="left"||j=="right";if(a.swf){a.swf.css({"float":k?j:"","vertical-align":k?"":j})}else{b(this).val("")}});this.src.margin.change(function(){if(a.swf){var j=a.src.margin.val();if(j.css){a.swf.css("margin",j.css)}else{a.swf.css("margin-top",j.top);a.swf.css("margin-right",j.right);a.swf.css("margin-bottom",j.bottom);a.swf.css("margin-left",j.left)}}});this.src.url.change(function(){var k=a.rte.utils.absoluteURL(b(this).val()),p,j;if(k){p=a.rte.utils.mediaInfo(a.src.type.val());if(!p){p=a.rte.util.mediaInfo("application/x-shockwave-flash")}j='<object classid="'+p.classid+'" codebase="'+p.codebase+'"><param name="src" value="'+k+'" /><embed quality="high" src="'+k+'" type="'+p.type+'"></object>';a.preview.children("object").remove().end().prepend(j);a.swf=a.preview.children("object").eq(0)}else{if(a.swf){a.swf.remove();a.swf=null}}a.src.width.trigger("change");a.src.height.trigger("change");a.src.align.trigger("change")}).trigger("change")};this.set=function(){a.swf=null;var H=this.rte.utils.absoluteURL(this.src.url.val()),w=parseInt(this.src.width.val())||"",M=parseInt(this.src.height.val())||"",o=this.src.wmode.val(),I=this.src.align.val(),K=I=="left"||I=="right"?I:"",E=this.placeholder?this.placeholder.attr("rel"):"",D,F,J,f=this.src.margin.val(),c;if(!H){if(this.placeholder){this.placeholder.remove();delete this.rte.filter.scripts[E]}}else{i=a.rte.utils.mediaInfo(a.src.type.val());if(!i){i=a.rte.util.mediaInfo("application/x-shockwave-flash")}J=this.rte.filter.videoHostRegExp.test(H)?H.replace(this.rte.filter.videoHostRegExp,"$2"):i.type.replace(/^\w+\/(.+)/,"$1");D={obj:{classid:i.classid[0],codebase:i.codebase,style:{}},params:[{name:"src",value:H}],embed:{src:H,type:i.type,quality:"high",wmode:o,style:{}}};if(w){D.obj.width=w;D.embed.width=w}if(M){D.obj.height=M;D.embed.height=M}if(K){D.obj.style["float"]=K}else{if(I){D.obj.style["vertical-align"]=I}}if(f.css){c={margin:f.css}}else{c={"margin-top":f.top,"margin-right":f.right,"margin-bottom":f.bottom,"margin-left":f.left}}D.obj.style=b.extend({},D.obj.style,c);if(this.placeholder&&E){F=this.rte.filter.scripts[E]||{};D=b.extend(true,F,D);delete D.obj.style.width;delete D.obj.style.height;delete D.embed.style.width;delete D.embed.style.height;this.rte.filter.scripts[E]=D;this.placeholder.removeAttr("class")}else{var G="media"+Math.random().toString().substring(2);this.rte.filter.scripts[G]=D;this.placeholder=b(this.rte.dom.create("img")).attr("rel",G).attr("src",this.rte.filter.url+"pixel.gif");var L=true}this.placeholder.attr("title",this.rte.utils.encode(H)).attr("width",w||150).attr("height",M||100).addClass("elrte-protected elrte-media elrte-media-"+J).css(D.obj.style);if(K){this.placeholder.css("float",K).css("vertical-align","")}else{if(I){this.placeholder.css("float","").css("vertical-align",I)}else{this.placeholder.css("float","").css("vertical-align","")}}if(L){this.rte.window.focus();this.rte.selection.restoreIERange();this.rte.selection.insertNode(this.placeholder.get(0))}}};this.update=function(){this.domElem.removeClass("disabled");var c=this.rte.selection.getNode();this.domElem.toggleClass("active",c&&c.nodeName=="IMG"&&b(c).hasClass("elrte-media"))}}})(jQuery);(function(b){elRTE.prototype.ui.prototype.buttons.fontname=function(j,k){this.constructor.prototype.constructor.call(this,j,k);var a=this;var h={tpl:'<span style="font-family:%val">%label</span>',select:function(c){a.set(c)},src:{"":this.rte.i18n("Font"),"andale mono,sans-serif":"Andale Mono","arial,helvetica,sans-serif":"Arial","arial black,gadget,sans-serif":"Arial Black","book antiqua,palatino,sans-serif":"Book Antiqua","comic sans ms,cursive":"Comic Sans MS","courier new,courier,monospace":"Courier New","georgia,palatino,serif":"Georgia","helvetica,sans-serif":"Helvetica","impact,sans-serif":"Impact","lucida console,monaco,monospace":"Lucida console","lucida sans unicode,lucida grande,sans-serif":"Lucida grande","tahoma,sans-serif":"Tahoma","times new roman,times,serif":"Times New Roman","trebuchet ms,lucida grande,verdana,sans-serif":"Trebuchet MS","verdana,geneva,sans-serif":"Verdana"}};this.select=this.domElem.elSelect(h);this.command=function(){};this.set=function(c){this.rte.history.add();var f=this.rte.selection.selected({filter:"textContainsNodes"});b.each(f,function(){$this=/^(THEAD|TFOOT|TBODY|COL|COLGROUP|TR)$/.test(this.nodeName)?b(this).find("td,th"):b(this);b(this).css("font-family",c).find("[style]").css("font-family","")});this.rte.ui.update()};this.update=function(){this.domElem.removeClass("disabled");var c=this.rte.selection.getNode();if(c.nodeType!=1){c=c.parentNode}var f=b(c).css("font-family");f=f?f.toString().toLowerCase().replace(/,\s+/g,",").replace(/'|"/g,""):"";this.select.val(h.src[f]?f:"")}}})(jQuery);(function(b){elRTE.prototype.ui.prototype.buttons.fontsize=function(j,k){this.constructor.prototype.constructor.call(this,j,k);var a=this;var h={labelTpl:"%label",tpl:'<span style="font-size:%val;line-height:1.2em">%label</span>',select:function(c){a.set(c)},src:{"":this.rte.i18n("Font size"),"xx-small":this.rte.i18n("Small (8pt)"),"x-small":this.rte.i18n("Small (10px)"),small:this.rte.i18n("Small (12pt)"),medium:this.rte.i18n("Normal (14pt)"),large:this.rte.i18n("Large (18pt)"),"x-large":this.rte.i18n("Large (24pt)"),"xx-large":this.rte.i18n("Large (36pt)")}};this.select=this.domElem.elSelect(h);this.command=function(){};this.set=function(c){this.rte.history.add();var f=this.rte.selection.selected({filter:"textContainsNodes"});b.each(f,function(){$this=/^(THEAD|TFOOT|TBODY|COL|COLGROUP|TR)$/.test(this.nodeName)?b(this).find("td,th"):b(this);$this.css("font-size",c).find("[style]").css("font-size","")});this.rte.ui.update()};this.update=function(){this.domElem.removeClass("disabled");var c=this.rte.selection.getNode();this.select.val((m=this.rte.dom.attr(c,"style").match(/font-size:\s*([^;]+)/i))?m[1]:"")}}})(jQuery);(function(b){elRTE.prototype.ui.prototype.buttons.forecolor=function(j,k){var a=this;this.constructor.prototype.constructor.call(this,j,k);var h={"class":"",palettePosition:"outer",color:this.defaultColor,update:function(c){a.indicator.css("background-color",c)},change:function(c){a.set(c)}};this.defaultColor=this.name=="forecolor"?"#000000":"#ffffff";this.picker=this.domElem.elColorPicker(h);this.indicator=b("<div />").addClass("color-indicator").prependTo(this.domElem);this.command=function(){};this.set=function(c){if(!this.rte.selection.collapsed()){this.rte.history.add();var g=this.rte.selection.selected({collapse:false,wrap:"text"}),f=this.name=="forecolor"?"color":"background-color";b.each(g,function(){if(/^(THEAD|TBODY|TFOOT|TR)$/.test(this.nodeName)){b(this).find("td,th").each(function(){b(this).css(f,c).find("*").css(f,"")})}else{b(this).css(f,c).find("*").css(f,"")}});this.rte.ui.update(true)}};this.update=function(){this.domElem.removeClass("disabled");var c=this.rte.selection.getNode();this.picker.val(this.rte.utils.rgb2hex(b(c.nodeType!=1?c.parentNode:c).css(this.name=="forecolor"?"color":"background-color"))||this.defaultColor)}};elRTE.prototype.ui.prototype.buttons.hilitecolor=elRTE.prototype.ui.prototype.buttons.forecolor})(jQuery);(function(b){elRTE.prototype.ui.prototype.buttons.formatblock=function(o,p){this.constructor.prototype.constructor.call(this,o,p);var j=this.rte.browser.msie?function(c){a.val=c;a.constructor.prototype.command.call(a)}:function(c){a.ieCommand(c)};var a=this;var k={labelTpl:"%label",tpls:{"":"%label"},select:function(c){a.formatBlock(c)},src:{span:this.rte.i18n("Format"),h1:this.rte.i18n("Heading 1"),h2:this.rte.i18n("Heading 2"),h3:this.rte.i18n("Heading 3"),h4:this.rte.i18n("Heading 4"),h5:this.rte.i18n("Heading 5"),h6:this.rte.i18n("Heading 6"),p:this.rte.i18n("Paragraph"),address:this.rte.i18n("Address"),pre:this.rte.i18n("Preformatted"),div:this.rte.i18n("Normal (DIV)")}};this.select=this.domElem.elSelect(k);this.command=function(){};this.formatBlock=function(A){function B(t,r){function q(u){b(u).find("h1,h2,h3,h4,h5,h6,p,address,pre").each(function(){b(this).replaceWith(b(this).html())});return u}if(/^(LI|DT|DD|TD|TH|CAPTION)$/.test(t.nodeName)){!a.rte.dom.isEmpty(t)&&a.rte.dom.wrapContents(q(t),r)}else{if(/^(UL|OL|DL|TABLE)$/.test(t.nodeName)){a.rte.dom.wrap(t,r)}else{!a.rte.dom.isEmpty(t)&&b(q(t)).replaceWith(b(a.rte.dom.create(r)).html(b(t).html()))}}}this.rte.history.add();var z=A.toUpperCase(),g,h,c,f=this.rte.selection.collapsed(),v=this.rte.selection.getBookmark(),x=this.rte.selection.selected({collapsed:true,blocks:true,filter:"textContainsNodes",wrap:"inline",tag:"span"});l=x.length,s=b(x[0]).prev(),e=b(x[x.length-1]).next();while(l--){h=x[l];c=b(h);if(z=="DIV"||z=="SPAN"){if(/^(H[1-6]|P|ADDRESS|PRE)$/.test(h.nodeName)){c.replaceWith(b(this.rte.dom.create("div")).html(c.html()||""))}}else{if(/^(THEAD|TBODY|TFOOT|TR)$/.test(h.nodeName)){c.find("td,th").each(function(){B(this,z)})}else{if(h.nodeName!=z){B(h,z)}}}}this.rte.selection.moveToBookmark(v);this.rte.ui.update(true)};this.update=function(){this.domElem.removeClass("disabled");var c=this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^(H[1-6]|P|ADDRESS|PRE)$/);this.select.val(c?c.nodeName.toLowerCase():"span")}}})(jQuery);(function(b){elRTE.prototype.ui.prototype.buttons.fullscreen=function(h,j){var a=this;this.constructor.prototype.constructor.call(this,h,j);this.active=true;this.editor=h.editor;this.wz=h.workzone;this.height=0;this.delta=0;this._class="el-fullscreen";setTimeout(function(){a.height=a.wz.height();a.delta=a.editor.outerHeight()-a.height},50);function k(){a.wz.height(b(window).height()-a.delta);a.rte.updateHeight()}this.command=function(){var p=b(window),J=this.editor,E=J.parents().filter(function(o,q){return !/^(html|body)$/i.test(q.nodeName)&&b(q).css("position")=="relative"}),g=this.wz,G=this._class,K=J.hasClass(G),F=this.rte,f=this.rte.selection,D=b.browser.mozilla,w,c;function H(){if(D){w=f.getBookmark()}}function I(){if(D){a.wz.children().toggle();a.rte.source.focus();a.wz.children().toggle();f.moveToBookmark(w)}}H();E.css("position",K?"relative":"static");if(K){J.removeClass(G);g.height(this.height);p.unbind("resize",k);this.domElem.removeClass("active")}else{J.addClass(G).removeAttr("style");g.height(p.height()-this.delta).css("width","100%");p.bind("resize",k);this.domElem.addClass("active")}F.updateHeight();F.resizable(K);I()};this.update=function(){this.domElem.removeClass("disabled")}}})(jQuery);(function(b){elRTE.prototype.ui.prototype.buttons.horizontalrule=function(g,h){this.constructor.prototype.constructor.call(this,g,h);var a=this;this.src={width:b('<input type="text" />').attr({name:"width",size:4}).css("text-align","right"),wunit:b("<select />").attr("name","wunit").append(b("<option />").val("%").text("%")).append(b("<option />").val("px").text("px")).val("%"),height:b('<input type="text" />').attr({name:"height",size:4}).css("text-align","right"),bg:b("<div />"),border:b("<div />"),"class":b('<input type="text" />').css("width","100%"),style:b('<input type="text" />').css("width","100%")};this.command=function(){this.src.bg.elColorPicker({palettePosition:"outer","class":"el-colorpicker ui-icon ui-icon-pencil"});var c=this.rte.selection.getEnd();this.hr=c.nodeName=="HR"?b(c):b(g.doc.createElement("hr")).css({width:"100%",height:"1px"});this.src.border.elBorderSelect({styleHeight:73,value:this.hr});var p=this.hr.css("width")||this.hr.attr("width");this.src.width.val(parseInt(p)||100);this.src.wunit.val(p.indexOf("px")!=-1?"px":"%");this.src.height.val(this.rte.utils.toPixels(this.hr.css("height")||this.hr.attr("height"))||1);this.src.bg.val(this.rte.utils.color2Hex(this.hr.css("background-color")));this.src["class"].val(this.rte.dom.attr(this.hr,"class"));this.src.style.val(this.rte.dom.attr(this.hr,"style"));var o={rtl:this.rte.rtl,submit:function(k,j){k.stopPropagation();k.preventDefault();a.set();j.close()},dialog:{title:this.rte.i18n("Horizontal rule")}};var f=new elDialogForm(o);f.append([this.rte.i18n("Width"),b("<span />").append(this.src.width).append(this.src.wunit)],null,true).append([this.rte.i18n("Height"),b("<span />").append(this.src.height).append(" px")],null,true).append([this.rte.i18n("Border"),this.src.border],null,true).append([this.rte.i18n("Background"),this.src.bg],null,true).append([this.rte.i18n("Css class"),this.src["class"]],null,true).append([this.rte.i18n("Css style"),this.src.style],null,true).open()};this.update=function(){this.domElem.removeClass("disabled");if(this.rte.selection.getEnd().nodeName=="HR"){this.domElem.addClass("active")}else{this.domElem.removeClass("active")}};this.set=function(){this.rte.history.add();!this.hr.parentNode&&this.rte.selection.insertNode(this.hr.get(0));var f={noshade:true,style:this.src.style.val()};var k=this.src.border.val();var c={width:(parseInt(this.src.width.val())||100)+this.src.wunit.val(),height:parseInt(this.src.height.val())||1,"background-color":this.src.bg.val(),border:k.width&&k.style?k.width+" "+k.style+" "+k.color:""};this.hr.removeAttr("class").removeAttr("style").removeAttr("width").removeAttr("height").removeAttr("align").attr(f).css(c);if(this.src["class"].val()){this.hr.attr("class",this.src["class"].val())}this.rte.ui.update()}}})(jQuery);(function(b){elRTE.prototype.ui.prototype.buttons.image=function(D,C){this.constructor.prototype.constructor.call(this,D,C);var t=this,D=t.rte,z=0,B=0,u=0,A=null,x=function(c){b.each(t.src,function(g,f){b.each(f,function(h,j){if(h=="src"&&c){return}j.val("")})})},v=function(c){b.each(t.src,function(g,f){b.each(f,function(k,r){var q,j,o,h,p;if(k=="width"){q=c.width()}else{if(k=="height"){q=c.height()}else{if(k=="border"){q="";p=c.css("border")||D.utils.parseStyle(c.attr("style")).border||"";if(p){j=p.match(/(\d(px|em|%))/);o=p.match(/(#[a-z0-9]+)/);q={width:j?j[1]:p,style:p,color:D.utils.color2Hex(o?o[1]:p)}}}else{if(k=="margin"){q=c}else{if(k=="align"){q=c.css("float");if(q!="left"&&q!="right"){q=c.css("vertical-align")}}else{q=c.attr(k)||""}}}}}if(g=="events"){q=D.utils.trimEventCallback(q)}r.val(q)})})},w=function(){var c=t.src.main.src.val();x(true);if(!c){t.preview.children("img").remove();t.prevImg=null}else{if(t.prevImg){t.prevImg.removeAttr("src").removeAttr("style").removeAttr("class").removeAttr("id").removeAttr("title").removeAttr("alt").removeAttr("longdesc");b.each(t.src.events,function(f,g){t.prevImg.removeAttr(f)})}else{t.prevImg=b("<img/>").prependTo(t.preview)}t.prevImg.load(function(){t.prevImg.unbind("load");setTimeout(function(){B=t.prevImg.width();u=t.prevImg.height();z=(B/u).toFixed(2);t.src.main.width.val(B);t.src.main.height.val(u)},100)}).attr("src",c)}},a=function(c){var g=parseInt(t.src.main.width.val())||0,f=parseInt(t.src.main.height.val())||0;if(t.prevImg){if(g&&f){if(c.target===t.src.main.width[0]){f=parseInt(g/z)}else{g=parseInt(f*z)}}else{g=B;f=u}t.src.main.height.val(f);t.src.main.width.val(g);t.prevImg.width(g).height(f);t.src.adv.style.val(t.prevImg.attr("style"))}};this.img=null;this.prevImg=null;this.preview=b('<div class="elrte-image-preview"/>').text("Proin elit arcu, rutrum commodo, vehicula tempus, commodo a, risus. Curabitur nec arcu. Donec sollicitudin mi sit amet mauris. Nam elementum quam ullamcorper ante. Etiam aliquet massa et lorem. Mauris dapibus lacus auctor risus. Aenean tempor ullamcorper leo. Vivamus sed magna quis ligula eleifend adipiscing. Duis orci. Aliquam sodales tortor vitae ipsum. Aliquam nulla. Duis aliquam molestie erat. Ut et mauris vel pede varius sollicitudin");this.init=function(){this.labels={main:"Properies",link:"Link",adv:"Advanced",events:"Events",id:"ID","class":"Css class",style:"Css style",longdesc:"Detail description URL",href:"URL",target:"Open in",title:"Title"};this.src={main:{src:b('<input type="text" />').css("width","100%").change(w),title:b('<input type="text" />').css("width","100%"),alt:b('<input type="text" />').css("width","100%"),width:b('<input type="text" />').attr("size",5).css("text-align","right").change(a),height:b('<input type="text" />').attr("size",5).css("text-align","right").change(a),margin:b("<div />").elPaddingInput({type:"margin",change:function(){var c=t.src.main.margin.val();if(t.prevImg){if(c.css){t.prevImg.css("margin",c.css)}else{t.prevImg.css({"margin-left":c.left,"margin-top":c.top,"margin-right":c.right,"margin-bottom":c.bottom})}}}}),align:b("<select />").css("width","100%").append(b("<option />").val("").text(this.rte.i18n("Not set","dialogs"))).append(b("<option />").val("left").text(this.rte.i18n("Left"))).append(b("<option />").val("right").text(this.rte.i18n("Right"))).append(b("<option />").val("top").text(this.rte.i18n("Top"))).append(b("<option />").val("text-top").text(this.rte.i18n("Text top"))).append(b("<option />").val("middle").text(this.rte.i18n("middle"))).append(b("<option />").val("baseline").text(this.rte.i18n("Baseline"))).append(b("<option />").val("bottom").text(this.rte.i18n("Bottom"))).append(b("<option />").val("text-bottom").text(this.rte.i18n("Text bottom"))).change(function(){var c=b(this).val(),f={"float":"","vertical-align":""};if(t.prevImg){if(c=="left"||c=="right"){f["float"]=c;f["vertical-align"]=""}else{if(c){f["float"]="";f["vertical-align"]=c}}t.prevImg.css(f)}}),border:b("<div />").elBorderSelect({name:"border",change:function(){var c=t.src.main.border.val();if(t.prevImg){t.prevImg.css("border",c.width?c.width+" "+c.style+" "+c.color:"")}}})},adv:{},events:{}};b.each(["id","class","style","longdesc"],function(c,f){t.src.adv[f]=b('<input type="text" style="width:100%" />')});this.src.adv["class"].change(function(){if(t.prevImg){t.prevImg.attr("class",b(this).val())}});this.src.adv.style.change(function(){if(t.prevImg){t.prevImg.attr("style",b(this).val());v(t.prevImg)}});b.each(["onblur","onfocus","onclick","ondblclick","onmousedown","onmouseup","onmouseover","onmouseout","onmouseleave","onkeydown","onkeypress","onkeyup"],function(){t.src.events[this]=b('<input type="text"  style="width:100%"/>')})};this.command=function(){!this.src&&this.init();var j,f={rtl:D.rtl,submit:function(o,k){o.stopPropagation();o.preventDefault();t.set();h.close()},close:function(){A&&D.selection.moveToBookmark(A)},dialog:{autoOpen:false,width:500,position:"top",title:D.i18n("Image"),resizable:true,open:function(){b.fn.resizable&&b(this).parents(".ui-dialog:first").resizable("option","alsoResize",".elrte-image-preview")}}},h=new elDialogForm(f),g=!!D.options.fmOpen,c=g?b('<div class="elrte-image-src-fm"><span class="ui-state-default ui-corner-all"><span class="ui-icon ui-icon-folder-open"/></span></div>').append(this.src.main.src.css("width","87%")):this.src.main.src;x();this.preview.children("img").remove();this.prevImg=null;j=D.selection.getEnd();this.img=j.nodeName=="IMG"&&!b(j).is(".elrte-protected")?b(j):b("<img/>");A=D.selection.getBookmark();if(g){c.children(".ui-state-default").click(function(){D.options.fmOpen(function(k){t.src.main.src.val(k).change()})}).hover(function(){b(this).toggleClass("ui-state-hover")})}h.tab("main",this.rte.i18n("Properies")).append([this.rte.i18n("Image URL"),c],"main",true).append([this.rte.i18n("Title"),this.src.main.title],"main",true).append([this.rte.i18n("Alt text"),this.src.main.alt],"main",true).append([this.rte.i18n("Size"),b("<span />").append(this.src.main.width).append(" x ").append(this.src.main.height).append(" px")],"main",true).append([this.rte.i18n("Alignment"),this.src.main.align],"main",true).append([this.rte.i18n("Margins"),this.src.main.margin],"main",true).append([this.rte.i18n("Border"),this.src.main.border],"main",true);h.append(b("<fieldset><legend>"+this.rte.i18n("Preview")+"</legend></fieldset>").append(this.preview),"main");b.each(this.src,function(k,o){if(k=="main"){return}h.tab(k,D.i18n(t.labels[k]));b.each(o,function(q,p){t.src[k][q].val(k=="events"?D.utils.trimEventCallback(t.img.attr(q)):t.img.attr(q)||"");h.append([D.i18n(t.labels[q]||q),t.src[k][q]],k,true)})});h.open();if(this.img.attr("src")){v(this.img);this.prevImg=this.img.clone().prependTo(this.preview);z=(this.img.width()/this.img.height()).toFixed(2);B=parseInt(this.img.width());u=parseInt(this.img.height())}};this.set=function(){var c=this.src.main.src.val(),f;this.rte.history.add();A&&D.selection.moveToBookmark(A);if(!c){f=D.dom.selfOrParentLink(this.img[0]);f&&f.remove();return this.img.remove()}!this.img[0].parentNode&&(this.img=b(this.rte.doc.createElement("img")));this.img.attr("src",c).attr("style",this.src.adv.style.val());b.each(this.src,function(h,g){b.each(g,function(k,j){var p=j.val(),o;switch(k){case"width":t.img.css("width",p);break;case"height":t.img.css("height",p);break;case"align":t.img.css(p=="left"||p=="right"?"float":"vertical-align",p);break;case"margin":if(p.css){t.img.css("margin",p.css)}else{t.img.css({"margin-left":p.left,"margin-top":p.top,"margin-right":p.right,"margin-bottom":p.bottom})}break;case"border":if(!p.width){p=""}else{p="border:"+p.css+";"+b.trim((t.img.attr("style")||"").replace(/border\-[^;]+;?/ig,""));k="style";t.img.attr("style",p);return}break;case"src":case"style":return;default:p?t.img.attr(k,p):t.img.removeAttr(k)}})});!this.img[0].parentNode&&D.selection.insertNode(this.img[0]);this.rte.ui.update()};this.update=function(){this.domElem.removeClass("disabled");var c=this.rte.selection.getEnd(),f=b(c);if(c.nodeName=="IMG"&&!f.hasClass("elrte-protected")){this.domElem.addClass("active")}else{this.domElem.removeClass("active")}}}})(jQuery);(function(b){elRTE.prototype.ui.prototype.buttons.indent=function(g,h){this.constructor.prototype.constructor.call(this,g,h);var a=this;this.command=function(){this.rte.history.add();var o=this.rte.selection.selected({collapsed:true,blocks:true,wrap:"inline",tag:"p"});function p(j){var r=/(IMG|HR|TABLE|EMBED|OBJECT)/.test(j.nodeName)?"margin-left":"padding-left";var k=a.rte.dom.attr(j,"style").indexOf(r)!=-1?parseInt(b(j).css(r))||0:0;b(j).css(r,k+40+"px")}for(var f=0;f<o.length;f++){if(/^(TABLE|THEAD|TFOOT|TBODY|COL|COLGROUP|TR)$/.test(o[f].nodeName)){b(o[f]).find("td,th").each(function(){p(this)})}else{if(/^LI$/.test(o[f].nodeName)){var c=b(o[f]);b(this.rte.dom.create(o[f].parentNode.nodeName)).append(b(this.rte.dom.create("li")).html(c.html()||"")).appendTo(c.html("&nbsp;"))}else{p(o[f])}}}this.rte.ui.update()};this.update=function(){this.domElem.removeClass("disabled")}}})(jQuery);(function(b){elRTE.prototype.ui.prototype.buttons.justifyleft=function(f,a){this.constructor.prototype.constructor.call(this,f,a);this.align=this.name=="justifyfull"?"justify":this.name.replace("justify","");this.command=function(){var c=this.rte.selection.selected({collapsed:true,blocks:true,tag:"div"}),h=c.length;h&&this.rte.history.add();while(h--){this.rte.dom.filter(c[h],"textNodes")&&b(c[h]).css("text-align",this.align)}this.rte.ui.update()};this.update=function(){var h=this.rte.selection.getNode(),c=h.nodeName=="BODY"?h:this.rte.dom.selfOrParent(h,"textNodes")||(h.parentNode&&h.parentNode.nodeName=="BODY"?h.parentNode:null);if(c){this.domElem.removeClass("disabled").toggleClass("active",b(c).css("text-align")==this.align)}else{this.domElem.addClass("disabled")}}};elRTE.prototype.ui.prototype.buttons.justifycenter=elRTE.prototype.ui.prototype.buttons.justifyleft;elRTE.prototype.ui.prototype.buttons.justifyright=elRTE.prototype.ui.prototype.buttons.justifyleft;elRTE.prototype.ui.prototype.buttons.justifyfull=elRTE.prototype.ui.prototype.buttons.justifyleft})(jQuery);(function(b){elRTE.prototype.ui.prototype.buttons.link=function(j,k){this.constructor.prototype.constructor.call(this,j,k);var a=this;this.img=false;this.bm;function h(){a.labels={id:"ID","class":"Css class",style:"Css style",dir:"Script direction",lang:"Language",charset:"Charset",type:"Target MIME type",rel:"Relationship page to target (rel)",rev:"Relationship target to page (rev)",tabindex:"Tab index",accesskey:"Access key"};a.src={main:{href:b('<input type="text" />'),title:b('<input type="text" />'),anchor:b("<select />").attr("name","anchor"),target:b("<select />").append(b("<option />").text(a.rte.i18n("In this window")).val("")).append(b("<option />").text(a.rte.i18n("In new window (_blank)")).val("_blank"))},popup:{use:b('<input type="checkbox" />'),url:b('<input type="text" />').val("http://"),name:b('<input type="text" />'),width:b('<input type="text" />').attr({size:6,title:a.rte.i18n("Width")}).css("text-align","right"),height:b('<input type="text" />').attr({size:6,title:a.rte.i18n("Height")}).css("text-align","right"),left:b('<input type="text" />').attr({size:6,title:a.rte.i18n("Left")}).css("text-align","right"),top:b('<input type="text" />').attr({size:6,title:a.rte.i18n("Top")}).css("text-align","right"),location:b('<input type="checkbox" />'),menubar:b('<input type="checkbox" />'),toolbar:b('<input type="checkbox" />'),scrollbars:b('<input type="checkbox" />'),status:b('<input type="checkbox" />'),resizable:b('<input type="checkbox" />'),dependent:b('<input type="checkbox" />'),retfalse:b('<input type="checkbox" />').attr("checked",true)},adv:{id:b('<input type="text" />'),"class":b('<input type="text" />'),style:b('<input type="text" />'),dir:b("<select />").append(b("<option />").text(a.rte.i18n("Not set")).val("")).append(b("<option />").text(a.rte.i18n("Left to right")).val("ltr")).append(b("<option />").text(a.rte.i18n("Right to left")).val("rtl")),lang:b('<input type="text" />'),charset:b('<input type="text" />'),type:b('<input type="text" />'),rel:b('<input type="text" />'),rev:b('<input type="text" />'),tabindex:b('<input type="text" />'),accesskey:b('<input type="text" />')},events:{}};b.each(["onblur","onfocus","onclick","ondblclick","onmousedown","onmouseup","onmouseover","onmouseout","onmouseleave","onkeydown","onkeypress","onkeyup"],function(){a.src.events[this]=b('<input type="text" />')});b.each(a.src,function(){for(var c in this){var f=this[c].attr("type");if(!f||(f=="text"&&!this[c].attr("size"))){this[c].css("width","100%")}}})}this.command=function(){var f=this.rte.selection.getNode(),g,E,C,A,F,v,D,r,B;!this.src&&h();this.bm=this.rte.selection.getBookmark();function c(o){return o.nodeName=="A"&&o.href}this.link=this.rte.dom.selfOrParentLink(f);if(!this.link){g=b.browser.msie?this.rte.selection.selected():this.rte.selection.selected({wrap:false});if(g.length){for(E=0;E<g.length;E++){if(c(g[E])){this.link=g[E];break}}if(!this.link){this.link=this.rte.dom.parent(g[0],c)||this.rte.dom.parent(g[g.length-1],c)}}}this.link=this.link?b(this.link):b(this.rte.doc.createElement("a"));this.img=f.nodeName=="IMG"?f:null;this.updatePopup();this.src.main.anchor.empty();b('a[href!=""][name]',this.rte.doc).each(function(){var o=b(this).attr("name");a.src.main.anchor.append(b("<option />").val(o).text(o))});if(this.src.main.anchor.children().length){this.src.main.anchor.prepend(b("<option />").val("").text(this.rte.i18n("Select bookmark"))).change(function(){var o=b(this).val();if(o){a.src.main.href.val("#"+o)}})}A={rtl:this.rte.rtl,submit:function(p,o){p.stopPropagation();p.preventDefault();a.set();o.close()},tabs:{show:function(o,p){if(p.index==3){a.updateOnclick()}}},close:function(){a.rte.browser.msie&&a.rte.selection.restoreIERange()},dialog:{width:"auto",width:430,title:this.rte.i18n("Link")}};d=new elDialogForm(A);F=b("<div />").append(b("<label />").append(this.src.popup.location).append(this.rte.i18n("Location bar"))).append(b("<label />").append(this.src.popup.menubar).append(this.rte.i18n("Menu bar"))).append(b("<label />").append(this.src.popup.toolbar).append(this.rte.i18n("Toolbar"))).append(b("<label />").append(this.src.popup.scrollbars).append(this.rte.i18n("Scrollbars")));v=b("<div />").append(b("<label />").append(this.src.popup.status).append(this.rte.i18n("Status bar"))).append(b("<label />").append(this.src.popup.resizable).append(this.rte.i18n("Resizable"))).append(b("<label />").append(this.src.popup.dependent).append(this.rte.i18n("Depedent"))).append(b("<label />").append(this.src.popup.retfalse).append(this.rte.i18n("Add return false")));d.tab("main",this.rte.i18n("Properies")).tab("popup",this.rte.i18n("Popup")).tab("adv",this.rte.i18n("Advanced")).tab("events",this.rte.i18n("Events")).append(b("<label />").append(this.src.popup.use).append(this.rte.i18n("Open link in popup window")),"popup").separator("popup").append([this.rte.i18n("URL"),this.src.popup.url],"popup",true).append([this.rte.i18n("Window name"),this.src.popup.name],"popup",true).append([this.rte.i18n("Window size"),b("<span />").append(this.src.popup.width).append(" x ").append(this.src.popup.height).append(" px")],"popup",true).append([this.rte.i18n("Window position"),b("<span />").append(this.src.popup.left).append(" x ").append(this.src.popup.top).append(" px")],"popup",true).separator("popup").append([F,v],"popup",true);D=this.link.get(0);r=this.rte.dom.attr(D,"href");this.src.main.href.val(r).change(function(){b(this).val(a.rte.utils.absoluteURL(b(this).val()))});if(this.rte.options.fmAllow&&this.rte.options.fmOpen){var B=b("<span />").append(this.src.main.href.css("width","87%")).append(b("<span />").addClass("ui-state-default ui-corner-all").css({"float":"right","margin-right":"3px"}).attr("title",a.rte.i18n("Open file manger")).append(b("<span />").addClass("ui-icon ui-icon-folder-open")).click(function(){a.rte.options.fmOpen(function(o){a.src.main.href.val(o).change()})}).hover(function(){b(this).addClass("ui-state-hover")},function(){b(this).removeClass("ui-state-hover")}));d.append([this.rte.i18n("Link URL"),B],"main",true)}else{d.append([this.rte.i18n("Link URL"),this.src.main.href],"main",true)}this.src.main.href.change();d.append([this.rte.i18n("Title"),this.src.main.title.val(this.rte.dom.attr(D,"title"))],"main",true);if(this.src.main.anchor.children().length){d.append([this.rte.i18n("Bookmark"),this.src.main.anchor.val(r)],"main",true)}if(!(this.rte.options.doctype.match(/xhtml/)&&this.rte.options.doctype.match(/strict/))){d.append([this.rte.i18n("Target"),this.src.main.target.val(this.link.attr("target")||"")],"main",true)}for(var f in this.src.adv){this.src.adv[f].val(this.rte.dom.attr(D,f));d.append([this.rte.i18n(this.labels[f]?this.labels[f]:f),this.src.adv[f]],"adv",true)}for(var f in this.src.events){var C=this.rte.utils.trimEventCallback(this.rte.dom.attr(D,f));this.src.events[f].val(C);d.append([this.rte.i18n(this.labels[f]?this.labels[f]:f),this.src.events[f]],"events",true)}this.src.popup.use.change(function(){var o=b(this).attr("checked");b.each(a.src.popup,function(){if(b(this).attr("name")!="use"){if(o){b(this).removeAttr("disabled")}else{b(this).attr("disabled",true)}}})});this.src.popup.use.change();d.open()};this.update=function(){var c=this.rte.selection.getNode();if(this.rte.dom.selfOrParentLink(c)){this.domElem.removeClass("disabled").addClass("active")}else{if(this.rte.dom.selectionHas(function(f){return f.nodeName=="A"&&f.href})){this.domElem.removeClass("disabled").addClass("active")}else{if(!this.rte.selection.collapsed()||c.nodeName=="IMG"){this.domElem.removeClass("disabled active")}else{this.domElem.addClass("disabled").removeClass("active")}}}};this.updatePopup=function(){var c=""+this.link.attr("onclick");if(c.length>0&&(m=c.match(/window.open\('([^']+)',\s*'([^']*)',\s*'([^']*)'\s*.*\);\s*(return\s+false)?/))){this.src.popup.use.attr("checked","on");this.src.popup.url.val(m[1]);this.src.popup.name.val(m[2]);if(/location=yes/.test(m[3])){this.src.popup.location.attr("checked",true)}if(/menubar=yes/.test(m[3])){this.src.popup.menubar.attr("checked",true)}if(/toolbar=yes/.test(m[3])){this.src.popup.toolbar.attr("checked",true)}if(/scrollbars=yes/.test(m[3])){this.src.popup.scrollbars.attr("checked",true)}if(/status=yes/.test(m[3])){this.src.popup.status.attr("checked",true)}if(/resizable=yes/.test(m[3])){this.src.popup.resizable.attr("checked",true)}if(/dependent=yes/.test(m[3])){this.src.popup.dependent.attr("checked",true)}if((_m=m[3].match(/width=([^,]+)/))){this.src.popup.width.val(_m[1])}if((_m=m[3].match(/height=([^,]+)/))){this.src.popup.height.val(_m[1])}if((_m=m[3].match(/left=([^,]+)/))){this.src.popup.left.val(_m[1])}if((_m=m[3].match(/top=([^,]+)/))){this.src.popup.top.val(_m[1])}if(m[4]){this.src.popup.retfalse.attr("checked",true)}}else{b.each(this.src.popup,function(){var f=b(this);if(f.attr("type")=="text"){f.val(f.attr("name")=="url"?"http://":"")}else{if(f.attr("name")=="retfalse"){this.attr("checked",true)}else{f.removeAttr("checked")}}})}};this.updateOnclick=function(){var r=this.src.popup.url.val();if(this.src.popup.use.attr("checked")&&r){var q="";if(this.src.popup.location.attr("checked")){q+="location=yes,"}if(this.src.popup.menubar.attr("checked")){q+="menubar=yes,"}if(this.src.popup.toolbar.attr("checked")){q+="toolbar=yes,"}if(this.src.popup.scrollbars.attr("checked")){q+="scrollbars=yes,"}if(this.src.popup.status.attr("checked")){q+="status=yes,"}if(this.src.popup.resizable.attr("checked")){q+="resizable=yes,"}if(this.src.popup.dependent.attr("checked")){q+="dependent=yes,"}if(this.src.popup.width.val()){q+="width="+this.src.popup.width.val()+","}if(this.src.popup.height.val()){q+="height="+this.src.popup.height.val()+","}if(this.src.popup.left.val()){q+="left="+this.src.popup.left.val()+","}if(this.src.popup.top.val()){q+="top="+this.src.popup.top.val()+","}if(q.length>0){q=q.substring(0,q.length-1)}var f=this.src.popup.retfalse.attr("checked")?"return false;":"";var c="window.open('"+r+"', '"+b.trim(this.src.popup.name.val())+"', '"+q+"'); "+f;this.src.events.onclick.val(c);if(!this.src.main.href.val()){this.src.main.href.val("#")}}else{var g=this.src.events.onclick.val();g=g.replace(/window\.open\([^\)]+\)\s*;?\s*return\s*false\s*;?/i,"");this.src.events.onclick.val(g)}};this.set=function(){var f,c;this.updateOnclick();this.rte.selection.moveToBookmark(this.bm);this.rte.history.add();f=this.rte.utils.absoluteURL(this.src.main.href.val());if(!f){var t=this.rte.selection.getBookmark();this.rte.dom.unwrap(this.link[0]);this.rte.selection.moveToBookmark(t)}else{if(this.img&&this.img.parentNode){this.link=b(this.rte.dom.create("a")).attr("href",f);this.rte.dom.wrap(this.img,this.link[0])}else{if(!this.link[0].parentNode){c="#--el-editor---"+Math.random();this.rte.doc.execCommand("createLink",false,c);this.link=b('a[href="'+c+'"]',this.rte.doc);this.link.each(function(){var o=b(this);if(!b.trim(o.html())&&!b.trim(o.text())){o.replaceWith(o.text())}})}}this.src.main.href.val(f);for(var u in this.src){if(u!="popup"){for(var r in this.src[u]){if(r!="anchors"){var g=b.trim(this.src[u][r].val());if(g){this.link.attr(r,g)}else{this.link.removeAttr(r)}}}}}this.img&&this.rte.selection.select(this.img)}this.rte.ui.update(true)}}})(jQuery);(function(b){elRTE.prototype.ui.prototype.buttons.nbsp=function(f,a){this.constructor.prototype.constructor.call(this,f,a);this.command=function(){this.rte.history.add();this.rte.selection.insertHtml("&nbsp;",true);this.rte.window.focus();this.rte.ui.update()};this.update=function(){this.domElem.removeClass("disabled")}}})(jQuery);(function(b){elRTE.prototype.ui.prototype.buttons.outdent=function(g,h){this.constructor.prototype.constructor.call(this,g,h);var a=this;this.command=function(){var c=this.find();if(c.node){this.rte.history.add();b(c.node).css(c.type,(c.val>40?c.val-40:0)+"px");this.rte.ui.update()}};this.find=function(c){function k(q){var j={type:"",val:0};var r;if((r=a.rte.dom.attr(q,"style"))){j.type=r.indexOf("padding-left")!=-1?"padding-left":(r.indexOf("margin-left")!=-1?"margin-left":"");j.val=j.type?parseInt(b(q).css(j.type))||0:0}return j}var c=this.rte.selection.getNode();var f=k(c);if(f.val){f.node=c}else{b.each(this.rte.dom.parents(c,"*"),function(){f=k(this);if(f.val){f.node=this;return f}})}return f};this.update=function(){var c=this.find();if(c.node){this.domElem.removeClass("disabled")}else{this.domElem.addClass("disabled")}}}})(jQuery);(function(b){elRTE.prototype.ui.prototype.buttons.pagebreak=function(f,a){this.constructor.prototype.constructor.call(this,f,a);b(this.rte.doc.body).bind("mousedown",function(c){if(b(c.target).hasClass("elrte-pagebreak")){c.preventDefault()}});this.command=function(){this.rte.selection.insertHtml('<img src="'+this.rte.filter.url+'pixel.gif" class="elrte-protected elrte-pagebreak"/>',false)};this.update=function(){this.domElem.removeClass("disabled")}}})(jQuery);(function(b){elRTE.prototype.ui.prototype.buttons.pasteformattext=function(g,h){this.constructor.prototype.constructor.call(this,g,h);this.iframe=b(document.createElement("iframe")).addClass("el-rte-paste-input");this.doc=null;var a=this;this.command=function(){this.rte.selection.saveIERange();var p=this,o={submit:function(k,j){k.stopPropagation();k.preventDefault();p.paste();j.close()},dialog:{width:500,title:this.rte.i18n("Paste formatted text")}},c=new elDialogForm(o);c.append(this.iframe).open();this.doc=this.iframe.get(0).contentWindow.document;html=this.rte.options.doctype+'<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />';html+="</head><body> <br /> </body></html>";this.doc.open();this.doc.write(html);this.doc.close();if(!this.rte.browser.msie){try{this.doc.designMode="on"}catch(f){}}else{this.doc.body.contentEditable=true}setTimeout(function(){p.iframe[0].contentWindow.focus()},50)};this.paste=function(){b(this.doc.body).find("[class]").removeAttr("class");var c=b.trim(b(this.doc.body).html());if(c){this.rte.history.add();this.rte.selection.restoreIERange();this.rte.selection.insertHtml(this.rte.filter.wysiwyg2wysiwyg(this.rte.filter.proccess("paste",c)));this.rte.ui.update(true)}};this.update=function(){this.domElem.removeClass("disabled")}}})(jQuery);(function(b){elRTE.prototype.ui.prototype.buttons.pastetext=function(g,h){this.constructor.prototype.constructor.call(this,g,h);this.input=b("<textarea />").addClass("el-rte-paste-input");var a=this;this.command=function(){this.rte.browser.msie&&this.rte.selection.saveIERange();var f={submit:function(p,o){p.stopPropagation();p.preventDefault();a.paste();o.close()},dialog:{width:500,title:this.rte.i18n("Paste only text")}};var c=new elDialogForm(f);c.append(this.input).open()};this.paste=function(){var c=b.trim(this.input.val());if(c){this.rte.history.add();this.rte.browser.msie&&this.rte.selection.restoreIERange();this.rte.selection.insertText(c.replace(/\r?\n/g,"<br />"),true);this.rte.ui.update(true)}this.input.val("")};this.update=function(){this.domElem.removeClass("disabled")}}})(jQuery);(function(b){elRTE.prototype.ui.prototype.buttons.save=function(f,a){this.constructor.prototype.constructor.call(this,f,a);this.active=true;this.command=function(){this.rte.save()};this.update=function(){}}})(jQuery);(function(b){elRTE.prototype.ui.prototype.buttons.smiley=function(g,h){this.constructor.prototype.constructor.call(this,g,h);var a=this;this.img=null;this.url=this.rte.filter.url+"smileys/";this.smileys={smile:"smile.png",happy:"happy.png",tongue:"tongue.png",surprised:"surprised.png",waii:"waii.png",wink:"wink.png",evilgrin:"evilgrin.png",grin:"grin.png",unhappy:"unhappy.png"};this.width=120;this.command=function(){var p=this,f=this.url,r,c,q;this.rte.browser.msie&&this.rte.selection.saveIERange();c={dialog:{height:120,width:this.width,title:this.rte.i18n("Smiley"),buttons:{}}};r=new elDialogForm(c);b.each(this.smileys,function(j,k){r.append(b('<img src="'+f+k+'" title="'+j+'" id="'+j+'" class="el-rte-smiley"/>').click(function(){p.set(this.id,r)}))});r.open()};this.update=function(){this.domElem.removeClass("disabled");this.domElem.removeClass("active")};this.set=function(f,c){this.rte.browser.msie&&this.rte.selection.restoreIERange();if(this.smileys[f]){this.img=b(this.rte.doc.createElement("img"));this.img.attr({src:this.url+this.smileys[f],title:f,alt:f});this.rte.selection.insertNode(this.img.get(0));this.rte.ui.update()}c.close()}}})(jQuery);(function(b){elRTE.prototype.ui.prototype.buttons.stopfloat=function(f,a){this.constructor.prototype.constructor.call(this,f,a);this.find=function(){if(this.rte.selection.collapsed()){var c=this.rte.dom.selfOrParent(this.rte.selection.getEnd(),/^DIV$/);if(c&&(this.rte.dom.attr(c,"clear")||b(c).css("clear")!="none")){return c}}};this.command=function(){var c;if((c=this.find())){var c=b(c);this.rte.history.add();if(!c.children().length&&!b.trim(c.text()).length){c.remove()}else{c.removeAttr("clear").css("clear","")}}else{this.rte.history.add();this.rte.selection.insertNode(b(this.rte.dom.create("div")).css("clear","both").get(0),true)}this.rte.ui.update(true)};this.update=function(){this.domElem.removeClass("disabled");if(this.find()){this.domElem.addClass("active")}else{this.domElem.removeClass("active")}}}})(jQuery);(function(b){elRTE.prototype.ui.prototype.buttons.table=function(j,k){this.constructor.prototype.constructor.call(this,j,k);var a=this;this.src=null;this.labels=null;function h(){a.labels={main:"Properies",adv:"Advanced",events:"Events",id:"ID","class":"Css class",style:"Css style",dir:"Script direction",summary:"Summary",lang:"Language",href:"URL"};a.src={main:{caption:b('<input type="text" />'),rows:b('<input type="text" />').attr("size",5).val(2),cols:b('<input type="text" />').attr("size",5).val(2),width:b('<input type="text" />').attr("size",5),wunit:b("<select />").append(b("<option />").val("%").text("%")).append(b("<option />").val("px").text("px")),height:b('<input type="text" />').attr("size",5),hunit:b("<select />").append(b("<option />").val("%").text("%")).append(b("<option />").val("px").text("px")),align:b("<select />").append(b("<option />").val("").text(a.rte.i18n("Not set"))).append(b("<option />").val("left").text(a.rte.i18n("Left"))).append(b("<option />").val("center").text(a.rte.i18n("Center"))).append(b("<option />").val("right").text(a.rte.i18n("Right"))),spacing:b('<input type="text" />').attr("size",5),padding:b('<input type="text" />').attr("size",5),border:b("<div />"),rules:b("<select />").append(b("<option />").val("none").text(a.rte.i18n("No"))).append(b("<option />").val("all").text(a.rte.i18n("Cells"))).append(b("<option />").val("groups").text(a.rte.i18n("Groups"))).append(b("<option />").val("rows").text(a.rte.i18n("Rows"))).append(b("<option />").val("cols").text(a.rte.i18n("Columns"))),margin:b("<div />"),bg:b("<div />"),bgimg:b('<input type="text" />').css("width","90%")},adv:{id:b('<input type="text" />'),summary:b('<input type="text" />'),"class":b('<input type="text" />'),style:b('<input type="text" />'),dir:b("<select />").append(b("<option />").text(a.rte.i18n("Not set")).val("")).append(b("<option />").text(a.rte.i18n("Left to right")).val("ltr")).append(b("<option />").text(a.rte.i18n("Right to left")).val("rtl")),lang:b('<input type="text" />')},events:{}};b.each(a.src,function(){for(var c in this){this[c].attr("name",c);var f=this[c].get(0).nodeName;if(f=="INPUT"&&c!="bgimg"){this[c].css(this[c].attr("size")?{"text-align":"right"}:{width:"100%"})}else{if(f=="SELECT"&&c!="wunit"&&c!="hunit"){this[c].css("width","100%")}}}});b.each(["onblur","onfocus","onclick","ondblclick","onmousedown","onmouseup","onmouseover","onmouseout","onmouseleave","onkeydown","onkeypress","onkeyup"],function(){a.src.events[this]=b('<input type="text" />').css("width","100%")});a.src.main.align.change(function(){var c=b(this).val();if(c=="center"){a.src.main.margin.val({left:"auto",right:"auto"})}else{var f=a.src.main.margin.val();if(f.left=="auto"&&f.right=="auto"){a.src.main.margin.val({left:"",right:""})}}});a.src.main.bgimg.change(function(){var c=b(this);c.val(a.rte.utils.absoluteURL(c.val()))})}this.command=function(){var f=this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^TABLE$/);if(this.name=="table"){this.table=b(this.rte.doc.createElement("table"))}else{this.table=f?b(f):b(this.rte.doc.createElement("table"))}!this.src&&h();this.src.main.border.elBorderSelect({styleHeight:117});this.src.main.bg.elColorPicker({palettePosition:"outer","class":"el-colorpicker ui-icon ui-icon-pencil"});this.src.main.margin.elPaddingInput({type:"margin",value:this.table});if(this.table.parents().length){this.src.main.rows.val("").attr("disabled",true);this.src.main.cols.val("").attr("disabled",true)}else{this.src.main.rows.val(2).removeAttr("disabled");this.src.main.cols.val(2).removeAttr("disabled")}var c=this.table.css("width")||this.table.attr("width");this.src.main.width.val(parseInt(c)||"");this.src.main.wunit.val(c.indexOf("px")!=-1?"px":"%");var K=this.table.css("height")||this.table.attr("height");this.src.main.height.val(parseInt(K)||"");this.src.main.hunit.val(K&&K.indexOf("px")!=-1?"px":"%");var w=this.table.css("float");this.src.main.align.val("");if(w=="left"||w=="right"){this.src.main.align.val(w)}else{var N=this.table.css("margin-left");var F=this.table.css("margin-right");if(N=="auto"&&F=="auto"){this.src.main.align.val("center")}}this.src.main.border.val(this.table);this.src.main.rules.val(this.rte.dom.attr(this.table.get(0),"rules"));this.src.main.bg.val(this.table.css("background-color"));var J=(this.table.css("background-image")||"").replace(/url\(([^\)]+)\)/i,"$1");this.src.main.bgimg.val(J!="none"?J:"");var I={rtl:this.rte.rtl,submit:function(p,o){p.stopPropagation();p.preventDefault();a.set();o.close()},dialog:{width:530,title:this.rte.i18n("Table")}};var v=new elDialogForm(I);for(var g in this.src){v.tab(g,this.rte.i18n(this.labels[g]));if(g=="main"){var H=b("<table />").append(b("<tr />").append("<td>"+this.rte.i18n("Rows")+"</td>").append(b("<td />").append(this.src.main.rows))).append(b("<tr />").append("<td>"+this.rte.i18n("Columns")+"</td>").append(b("<td />").append(this.src.main.cols)));var L=b("<table />").append(b("<tr />").append("<td>"+this.rte.i18n("Width")+"</td>").append(b("<td />").append(this.src.main.width).append(this.src.main.wunit))).append(b("<tr />").append("<td>"+this.rte.i18n("Height")+"</td>").append(b("<td />").append(this.src.main.height).append(this.src.main.hunit)));var M=b("<table />").append(b("<tr />").append("<td>"+this.rte.i18n("Spacing")+"</td>").append(b("<td />").append(this.src.main.spacing.val(this.table.attr("cellspacing")||"")))).append(b("<tr />").append("<td>"+this.rte.i18n("Padding")+"</td>").append(b("<td />").append(this.src.main.padding.val(this.table.attr("cellpadding")||""))));v.append([this.rte.i18n("Caption"),this.src.main.caption.val(this.table.find("caption").eq(0).text()||"")],"main",true).separator("main").append([H,L,M],"main",true).separator("main").append([this.rte.i18n("Border"),this.src.main.border],"main",true).append([this.rte.i18n("Inner borders"),this.src.main.rules],"main",true).append([this.rte.i18n("Alignment"),this.src.main.align],"main",true).append([this.rte.i18n("Margins"),this.src.main.margin],"main",true).append([this.rte.i18n("Background"),b("<span />").append(b("<span />").css({"float":"left","margin-right":"3px"}).append(this.src.main.bg)).append(this.src.main.bgimg)],"main",true)}else{for(var G in this.src[g]){var O=this.rte.dom.attr(this.table,G);if(g=="events"){O=this.rte.utils.trimEventCallback(O)}v.append([this.rte.i18n(this.labels[G]?this.labels[G]:G),this.src[g][G].val(O)],g,true)}}}v.open()};this.set=function(){if(!this.table.parents().length){var K=parseInt(this.src.main.rows.val())||0;var r=parseInt(this.src.main.cols.val())||0;if(K<=0||r<=0){return}this.rte.history.add();var c=b(this.rte.doc.createElement("tbody")).appendTo(this.table);for(var Q=0;Q<K;Q++){var g="<tr>";for(var S=0;S<r;S++){g+="<td>&nbsp;</td>"}c.append(g+"</tr>")}}else{this.table.removeAttr("width").removeAttr("height").removeAttr("border").removeAttr("align").removeAttr("bordercolor").removeAttr("bgcolor").removeAttr("cellspacing").removeAttr("cellpadding").removeAttr("frame").removeAttr("rules").removeAttr("style")}var N=b.trim(this.src.main.caption.val());if(N){if(!this.table.children("caption").length){this.table.prepend("<caption />")}this.table.children("caption").text(N)}else{this.table.children("caption").remove()}for(var v in this.src){if(v!="main"){for(var J in this.src[v]){var P=b.trim(this.src[v][J].val());if(P){this.table.attr(J,P)}else{this.table.removeAttr(J)}}}}var w,T,O;if((w=parseInt(this.src.main.spacing.val()))&&w>=0){this.table.attr("cellspacing",w)}if((T=parseInt(this.src.main.padding.val()))&&T>=0){this.table.attr("cellpadding",T)}if((O=this.src.main.rules.val())){this.table.attr("rules",O)}var R=parseInt(this.src.main.width.val())||"",M=parseInt(this.src.main.height.val())||"",Q=b.trim(this.src.main.bgimg.val()),c=this.src.main.border.val(),f=this.src.main.margin.val(),L=this.src.main.align.val();this.table.css({width:R?R+this.src.main.wunit.val():"",height:M?M+this.src.main.hunit.val():"",border:b.trim(c.width+" "+c.style+" "+c.color),"background-color":this.src.main.bg.val(),"background-image":Q?"url("+Q+")":""});if(f.css){this.table.css("margin",f.css)}else{this.table.css({"margin-top":f.top,"margin-right":f.right,"margin-bottom":f.bottom,"margin-left":f.left})}if((L=="left"||L=="right")&&this.table.css("margin-left")!="auto"&&this.table.css("margin-right")!="auto"){this.table.css("float",L)}if(!this.table.attr("style")){this.table.removeAttr("style")}if(!this.table.parents().length){this.rte.selection.insertNode(this.table.get(0),true)}this.rte.ui.update()};this.update=function(){this.domElem.removeClass("disabled");if(this.name=="tableprops"&&!this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^TABLE$/)){this.domElem.addClass("disabled").removeClass("active")}}};elRTE.prototype.ui.prototype.buttons.tableprops=elRTE.prototype.ui.prototype.buttons.table})(jQuery);(function(b){elRTE.prototype.ui.prototype.buttons.tablerm=function(f,a){this.constructor.prototype.constructor.call(this,f,a);this.command=function(){var c=this.rte.dom.parent(this.rte.selection.getNode(),/^TABLE$/);if(c){this.rte.history.add();b(c).remove()}this.rte.ui.update(true)};this.update=function(){if(this.rte.dom.parent(this.rte.selection.getNode(),/^TABLE$/)){this.domElem.removeClass("disabled")}else{this.domElem.addClass("disabled")}}}})(jQuery);(function(b){elRTE.prototype.ui.prototype.buttons.tbcellprops=function(j,k){this.constructor.prototype.constructor.call(this,j,k);var a=this;this.src=null;this.labels=null;function h(){a.labels={main:"Properies",adv:"Advanced",events:"Events",id:"ID","class":"Css class",style:"Css style",dir:"Script direction",lang:"Language"};a.src={main:{type:b("<select />").css("width","100%").append(b("<option />").val("td").text(a.rte.i18n("Data"))).append(b("<option />").val("th").text(a.rte.i18n("Header"))),width:b('<input type="text" />').attr("size",4),wunit:b("<select />").append(b("<option />").val("%").text("%")).append(b("<option />").val("px").text("px")),height:b('<input type="text" />').attr("size",4),hunit:b("<select />").append(b("<option />").val("%").text("%")).append(b("<option />").val("px").text("px")),align:b("<select />").css("width","100%").append(b("<option />").val("").text(a.rte.i18n("Not set"))).append(b("<option />").val("left").text(a.rte.i18n("Left"))).append(b("<option />").val("center").text(a.rte.i18n("Center"))).append(b("<option />").val("right").text(a.rte.i18n("Right"))).append(b("<option />").val("justify").text(a.rte.i18n("Justify"))),border:b("<div />"),padding:b("<div />"),bg:b("<div />"),bgimg:b('<input type="text" />').css("width","90%"),apply:b("<select />").css("width","100%").append(b("<option />").val("").text(a.rte.i18n("Current cell"))).append(b("<option />").val("row").text(a.rte.i18n("All cells in row"))).append(b("<option />").val("column").text(a.rte.i18n("All cells in column"))).append(b("<option />").val("table").text(a.rte.i18n("All cells in table")))},adv:{id:b('<input type="text" />'),"class":b('<input type="text" />'),style:b('<input type="text" />'),dir:b("<select />").css("width","100%").append(b("<option />").text(a.rte.i18n("Not set")).val("")).append(b("<option />").text(a.rte.i18n("Left to right")).val("ltr")).append(b("<option />").text(a.rte.i18n("Right to left")).val("rtl")),lang:b('<input type="text" />')},events:{}};b.each(a.src,function(){for(var c in this){this[c].attr("name",c);if(this[c].attr("type")=="text"&&!this[c].attr("size")&&c!="bgimg"){this[c].css("width","100%")}}});b.each(["onblur","onfocus","onclick","ondblclick","onmousedown","onmouseup","onmouseover","onmouseout","onmouseleave","onkeydown","onkeypress","onkeyup"],function(){a.src.events[this]=b('<input type="text" />').css("width","100%")})}this.command=function(){!this.src&&h();this.cell=this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^(TD|TH)$/);if(!this.cell){return}this.src.main.type.val(this.cell.nodeName.toLowerCase());this.cell=b(this.cell);this.src.main.border.elBorderSelect({styleHeight:117,value:this.cell});this.src.main.bg.elColorPicker({palettePosition:"outer","class":"el-colorpicker ui-icon ui-icon-pencil"});this.src.main.padding.elPaddingInput({value:this.cell});var g=this.cell.css("width")||this.cell.attr("width");this.src.main.width.val(parseInt(g)||"");this.src.main.wunit.val(g.indexOf("px")!=-1?"px":"%");var x=this.cell.css("height")||this.cell.attr("height");this.src.main.height.val(parseInt(x)||"");this.src.main.hunit.val(x.indexOf("px")!=-1?"px":"%");this.src.main.align.val(this.cell.attr("align")||this.cell.css("text-align"));this.src.main.bg.val(this.cell.css("background-color"));var v=this.cell.css("background-image");this.src.main.bgimg.val(v&&v!="none"?v.replace(/url\(([^\)]+)\)/i,"$1"):"");this.src.main.apply.val("");var w={rtl:this.rte.rtl,submit:function(p,o){p.stopPropagation();p.preventDefault();a.set();o.close()},dialog:{width:520,title:this.rte.i18n("Table cell properties")}};var f=new elDialogForm(w);for(var z in this.src){f.tab(z,this.rte.i18n(this.labels[z]));if(z=="main"){f.append([this.rte.i18n("Width"),b("<span />").append(this.src.main.width).append(this.src.main.wunit)],"main",true).append([this.rte.i18n("Height"),b("<span />").append(this.src.main.height).append(this.src.main.hunit)],"main",true).append([this.rte.i18n("Table cell type"),this.src.main.type],"main",true).append([this.rte.i18n("Border"),this.src.main.border],"main",true).append([this.rte.i18n("Alignment"),this.src.main.align],"main",true).append([this.rte.i18n("Paddings"),this.src.main.padding],"main",true).append([this.rte.i18n("Background"),b("<span />").append(b("<span />").css({"float":"left","margin-right":"3px"}).append(this.src.main.bg)).append(this.src.main.bgimg)],"main",true).append([this.rte.i18n("Apply to"),this.src.main.apply],"main",true)}else{for(var A in this.src[z]){var c=this.cell.attr(A)||"";if(z=="events"){c=this.rte.utils.trimEventCallback(c)}f.append([this.rte.i18n(this.labels[A]?this.labels[A]:A),this.src[z][A].val(c)],z,true)}}}f.open()};this.set=function(){var H=this.cell,t=this.src.main.apply.val();switch(this.src.main.apply.val()){case"row":H=this.cell.parent("tr").children("td,th");break;case"column":H=b(this.rte.dom.tableColumn(this.cell.get(0)));break;case"table":H=this.cell.parents("table").find("td,th");break}for(var v in this.src){if(v!="main"){for(var E in this.src[v]){var p=b.trim(this.src[v][E].val());if(p){H.attr(E,p)}else{H.removeAttr(E)}}}}H.removeAttr("width").removeAttr("height").removeAttr("border").removeAttr("align").removeAttr("bordercolor").removeAttr("bgcolor");var c=this.src.main.type.val();var w=parseInt(this.src.main.width.val())||"";var f=parseInt(this.src.main.height.val())||"";var g=b.trim(this.src.main.bgimg.val());var G=this.src.main.border.val();var I={width:w?w+this.src.main.wunit.val():"",height:f?f+this.src.main.hunit.val():"","background-color":this.src.main.bg.val(),"background-image":g?"url("+g+")":"",border:b.trim(G.width+" "+G.style+" "+G.color),"text-align":this.src.main.align.val()||""};var F=this.src.main.padding.val();if(F.css){I.padding=F.css}else{I["padding-top"]=F.top;I["padding-right"]=F.right;I["padding-bottom"]=F.bottom;I["padding-left"]=F.left}H=H.get();b.each(H,function(){var o=this.nodeName.toLowerCase();var x=b(this);if(o!=c){var u={};for(var q in a.src.adv){var A=x.attr(q);if(A){u[q]=A.toString()}}for(var q in a.src.events){var A=x.attr(q);if(A){u[q]=A.toString()}}var r=x.attr("colspan")||1;var z=x.attr("rowspan")||1;if(r>1){u.colspan=r}if(z>1){u.rowspan=z}x.replaceWith(b("<"+c+" />").html(x.html()).attr(u).css(I))}else{x.css(I)}});this.rte.ui.update()};this.update=function(){if(this.rte.dom.parent(this.rte.selection.getNode(),/^TABLE$/)){this.domElem.removeClass("disabled")}else{this.domElem.addClass("disabled")}}}})(jQuery);(function(b){elRTE.prototype.ui.prototype.buttons.tbcellsmerge=function(h,j){this.constructor.prototype.constructor.call(this,h,j);var k=this;function a(){var c=k.rte.dom.selfOrParent(k.rte.selection.getStart(),/^(TD|TH)$/);var f=k.rte.dom.selfOrParent(k.rte.selection.getEnd(),/^(TD|TH)$/);if(c&&f&&c!=f&&b(c).parents("table").get(0)==b(f).parents("table").get(0)){return[c,f]}return null}this.command=function(){var I=a();if(I){var J=this.rte.dom.indexOf(b(I[0]).parent("tr").get(0));var c=this.rte.dom.indexOf(b(I[1]).parent("tr").get(0));var f=Math.min(J,c);var M=Math.max(J,c)-f+1;var G=this.rte.dom.tableColumn(I[0],true,true);var H=this.rte.dom.tableColumn(I[1],true);var C=b.inArray(I[0],G.column);var K=b.inArray(I[1],H.column);var g=G.info.offset[C]<H.info.offset[K]?G:H;var L=G.info.offset[C]>=H.info.offset[K]?G:H;var F=0;var N=null;var E="";this.rte.history.add();var D=b(b(I[0]).parents("table").eq(0).find("tr").get().slice(f,f+M)).each(function(o){var p=E.length;var q=false;b(this).children("td,th").each(function(){var t=b(this);var v=b.inArray(this,g.column);var w=b.inArray(this,L.column);if(v!=-1||w!=-1){q=v!=-1&&w==-1;var x=parseInt(t.attr("colspan")||1);if(o==0){F+=x}if(v!=-1&&o>0){var r=g.info.delta[v];if(r>0){if(t.css("text-align")=="left"){var z=t.clone(true);t.html("&nbsp;")}else{var z=t.clone().html("&nbsp;")}z.removeAttr("colspan").removeAttr("id").insertBefore(this);if(r>1){z.attr("colspan",r)}}}if(w!=-1){var r=L.info.delta[w];if(x-r>1){var u=x-r-1;if(t.css("text-align")=="right"){var z=t.clone(true);t.html("&nbsp;")}else{var z=t.clone().html("&nbsp;")}z.removeAttr("colspan").removeAttr("id").insertAfter(this);if(u>1){z.attr("colspan",u)}}}if(!N){N=t}else{E+=t.html();t.remove()}}else{if(q){if(o==0){F+=parseInt(t.attr("colspan")||1)}E+=t.html();t.remove()}}});E+=p!=E.length?"<br />":""});N.removeAttr("colspan").removeAttr("rowspan").html(N.html()+E);if(F>1){N.attr("colspan",F)}if(M>1){N.attr("rowspan",M)}this.rte.dom.fixTable(b(I[0]).parents("table").get(0))}};this.update=function(){if(a()){this.domElem.removeClass("disabled")}else{this.domElem.addClass("disabled")}}}})(jQuery);(function(b){elRTE.prototype.ui.prototype.buttons.tbcellsplit=function(f,a){this.constructor.prototype.constructor.call(this,f,a);this.command=function(){var B=this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^(TD|TH)$/);if(B){this.rte.history.add();var A=parseInt(this.rte.dom.attr(B,"colspan"));var z=parseInt(this.rte.dom.attr(B,"rowspan"));if(A>1||z>1){var I=A-1;var H=z-1;var c=this.rte.dom.parent(B,/^TABLE$/);var r=this.rte.dom.tableMatrix(c);if(I){for(var J=0;J<I;J++){b(this.rte.dom.create(B.nodeName)).html("&nbsp;").insertAfter(B)}}if(H){var F=this.rte.dom.indexesOfCell(B,r);var C=F[0];var D=F[1];for(var E=C+1;E<C+H+1;E++){var G;if(!r[E][D].nodeName){if(r[E][D-1].nodeName){G=r[E][D-1]}else{for(var J=D-1;J>=0;J--){if(r[E][J].nodeName){G=r[E][J];break}}}if(G){for(var J=0;J<=I;J++){b(this.rte.dom.create(G.nodeName)).html("&nbsp;").insertAfter(G)}}}}}b(B).removeAttr("colspan").removeAttr("rowspan");this.rte.dom.fixTable(c)}}this.rte.ui.update(true)};this.update=function(){var c=this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^(TD|TH)$/);if(c&&(parseInt(this.rte.dom.attr(c,"colspan"))>1||parseInt(this.rte.dom.attr(c,"rowspan"))>1)){this.domElem.removeClass("disabled")}else{this.domElem.addClass("disabled")}}}})(jQuery);(function(b){elRTE.prototype.ui.prototype.buttons.tbcolbefore=function(g,h){this.constructor.prototype.constructor.call(this,g,h);var a=this;this.command=function(){var f=this;var c=this.rte.dom.tableColumn(this.rte.selection.getNode(),false,true);if(c.length){this.rte.history.add();b.each(c,function(){var p=b(this);var q=parseInt(p.attr("colspan")||1);if(q>1){p.attr("colspan",q+1)}else{var r=b(f.rte.dom.create(this.nodeName)).html("&nbsp;");if(f.name=="tbcolbefore"){r.insertBefore(this)}else{r.insertAfter(this)}}});this.rte.ui.update()}};this.update=function(){if(this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^(TD|TH)$/)){this.domElem.removeClass("disabled")}else{this.domElem.addClass("disabled")}}};elRTE.prototype.ui.prototype.buttons.tbcolafter=elRTE.prototype.ui.prototype.buttons.tbcolbefore})(jQuery);(function(b){elRTE.prototype.ui.prototype.buttons.tbcolrm=function(g,h){this.constructor.prototype.constructor.call(this,g,h);var a=this;this.command=function(){var t=this.rte.selection.getNode();var u=this.rte.dom.selfOrParent(t,/^(TD|TH)$/);var c=b(u).prev("td,th").get(0);var f=b(u).next("td,th").get(0);var r=this.rte.dom.parent(t,/^TABLE$/);var q=this.rte.dom.tableColumn(t,false,true);if(q.length){this.rte.history.add();b.each(q,function(){var j=b(this);var k=parseInt(j.attr("colspan")||1);if(k>1){j.attr("colspan",k-1)}else{j.remove()}});this.rte.dom.fixTable(r);if(c||f){this.rte.selection.selectContents(c?c:f).collapse(true)}this.rte.ui.update(true)}};this.update=function(){if(this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^(TD|TH)$/)){this.domElem.removeClass("disabled")}else{this.domElem.addClass("disabled")}}}})(jQuery);elRTE.prototype.ui.prototype.buttons.tbrowbefore=function(c,f){this.constructor.prototype.constructor.call(this,c,f);this.command=function(){var B=this.rte.selection.getNode();var I=this.rte.dom.selfOrParent(B,/^(TD|TH)$/);var D=this.rte.dom.selfOrParent(I,/^TR$/);var F=this.rte.dom.tableMatrix(this.rte.dom.selfOrParent(I,/^TABLE$/));if(I&&D&&F){this.rte.history.add();var H=this.name=="tbrowbefore";var a=$(D).prevAll("tr").length;var A=0;var b=[];function z(h,g){while(g>0){g--;if(F[g]&&F[g][h]&&F[g][h].nodeName){return F[g][h]}}}for(var r=0;r<F[a].length;r++){if(F[a][r]&&F[a][r].nodeName){var G=$(F[a][r]);var C=parseInt(G.attr("colspan")||1);if(parseInt(G.attr("rowspan")||1)>1){if(H){A+=C}else{b.push(G)}}else{A+=C}}else{if(F[a][r]=="-"){G=z(r,a);G&&b.push($(G))}}}var E=$(this.rte.dom.create("tr"));for(var r=0;r<A;r++){E.append("<td>&nbsp;</td>")}if(H){E.insertBefore(D)}else{E.insertAfter(D)}$.each(b,function(){$(this).attr("rowspan",parseInt($(this).attr("rowspan")||1)+1)});this.rte.ui.update()}};this.update=function(){if(this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^TR$/)){this.domElem.removeClass("disabled")}else{this.domElem.addClass("disabled")}}};elRTE.prototype.ui.prototype.buttons.tbrowafter=elRTE.prototype.ui.prototype.buttons.tbrowbefore;(function(b){elRTE.prototype.ui.prototype.buttons.tbrowrm=function(g,h){this.constructor.prototype.constructor.call(this,g,h);var a=this;this.command=function(){var G=this.rte.selection.getNode(),J=this.rte.dom.selfOrParent(G,/^(TD|TH)$/),H=this.rte.dom.selfOrParent(J,/^TR$/),c=this.rte.dom.selfOrParent(J,/^TABLE$/),D=this.rte.dom.tableMatrix(c);if(J&&H&&D.length){this.rte.history.add();if(D.length==1){b(c).remove();return this.rte.ui.update()}var M=[];var L=b(H).prevAll("tr").length;function r(j,k){while(k>0){k--;if(D[k]&&D[k][j]&&D[k][j].nodeName){return D[k][j]}}}function f(p,j){y=L+1;var k=null;if(D[y]){for(var o=0;o<j;o++){if(D[y][o]&&D[y][o].nodeName){k=D[y][o]}}p=p.remove();if(k){p.insertAfter(k)}else{p.prependTo(b(H).next("tr").eq(0))}}}function C(k){for(var j=0;j<k.length;j++){if(k[j]==J){return j<k.length-1?k[j+1]:k[j-1]}}}for(var N=0;N<D[L].length;N++){var I=null;var F=false;if(D[L][N]&&D[L][N].nodeName){I=D[L][N];F=true}else{if(D[L][N]=="-"&&(I=r(N,L))){F=false}}if(I){I=b(I);var E=parseInt(I.attr("rowspan")||1);if(E>1){I.attr("rowspan",E-1);F&&f(I,N,L)}}}var K=C(this.rte.dom.tableColumn(J));if(K){this.rte.selection.selectContents(K).collapse(true)}b(H).remove()}this.rte.ui.update()};this.update=function(){if(this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^TR$/)){this.domElem.removeClass("disabled")}else{this.domElem.addClass("disabled")}}}})(jQuery);(function(b){elRTE.prototype.ui.prototype.buttons.undo=function(f,a){this.constructor.prototype.constructor.call(this,f,a);this.command=function(){if(this.name=="undo"&&this.rte.history.canBack()){this.rte.history.back();this.rte.ui.update()}else{if(this.name=="redo"&&this.rte.history.canFwd()){this.rte.history.fwd();this.rte.ui.update()}}};this.update=function(){this.domElem.toggleClass("disabled",this.name=="undo"?!this.rte.history.canBack():!this.rte.history.canFwd())}};elRTE.prototype.ui.prototype.buttons.redo=elRTE.prototype.ui.prototype.buttons.undo})(jQuery);(function(b){elRTE.prototype.ui.prototype.buttons.unlink=function(f,a){this.constructor.prototype.constructor.call(this,f,a);this.command=function(){var c=this.rte.selection.getNode(),r=this.rte.dom.selfOrParentLink(c);function o(g){return g.nodeName=="A"&&g.href}if(!r){var p=b.browser.msie?this.rte.selection.selected():this.rte.selection.selected({wrap:false});if(p.length){for(var q=0;q<p.length;q++){if(o(p[q])){r=p[q];break}}if(!r){r=this.rte.dom.parent(p[0],o)||this.rte.dom.parent(p[p.length-1],o)}}}if(r){this.rte.history.add();this.rte.selection.select(r);this.rte.doc.execCommand("unlink",false,null);this.rte.ui.update(true)}};this.update=function(){var c=this.rte.selection.getNode();if(this.rte.dom.selfOrParentLink(c)){this.domElem.removeClass("disabled").addClass("active")}else{if(this.rte.dom.selectionHas(function(h){return h.nodeName=="A"&&h.href})){this.domElem.removeClass("disabled").addClass("active")}else{this.domElem.addClass("disabled").removeClass("active")}}}}})(jQuery);jQuery.extend({createUploadIframe:function(f,b){var a="jUploadFrame"+f;if(window.ActiveXObject){var c=document.createElement('<iframe id="'+a+'" name="'+a+'" />');if(typeof b=="boolean"){c.src="javascript:false"}else{if(typeof b=="string"){c.src=b}}}else{var c=document.createElement("iframe");c.id=a;c.name=a}c.style.position="absolute";c.style.top="-1000px";c.style.left="-1000px";document.body.appendChild(c);return c},createUploadForm:function(j,b){var g="jUploadForm"+j;var a="jUploadFile"+j;var f=$('<form  action="" method="POST" name="'+g+'" id="'+g+'" enctype="multipart/form-data"></form>');var c=$("#"+b);var h=$(c).clone();$(c).attr("id",a);$(c).before(h);$(c).appendTo(f);$(f).css("position","absolute");$(f).css("top","-1200px");$(f).css("left","-1200px");$(f).appendTo("body");return f},ajaxFileUpload:function(p){p=jQuery.extend({},jQuery.ajaxSettings,p);var a=new Date().getTime();var b=jQuery.createUploadForm(a,p.fileElementId);var k=jQuery.createUploadIframe(a,p.secureuri);var j="jUploadFrame"+a;var o="jUploadForm"+a;if(p.global&&!jQuery.active++){jQuery.event.trigger("ajaxStart")}var c=false;var g={};if(p.global){jQuery.event.trigger("ajaxSend",[g,p])}var f=function(q){var v=document.getElementById(j);try{if(v.contentWindow){g.responseText=v.contentWindow.document.body?v.contentWindow.document.body.innerHTML:null;g.responseXML=v.contentWindow.document.XMLDocument?v.contentWindow.document.XMLDocument:v.contentWindow.document}else{if(v.contentDocument){g.responseText=v.contentDocument.document.body?v.contentDocument.document.body.innerHTML:null;g.responseXML=v.contentDocument.document.XMLDocument?v.contentDocument.document.XMLDocument:v.contentDocument.document}}}catch(u){jQuery.handleError(p,g,null,u)}if(g||q=="timeout"){c=true;var r;try{r=q!="timeout"?"success":"error";if(r!="error"){var t=jQuery.uploadHttpData(g,p.dataType);if(p.success){p.success(t,r)}if(p.global){jQuery.event.trigger("ajaxSuccess",[g,p])}}else{jQuery.handleError(p,g,r)}}catch(u){r="error";jQuery.handleError(p,g,r,u)}if(p.global){jQuery.event.trigger("ajaxComplete",[g,p])}if(p.global&&!--jQuery.active){jQuery.event.trigger("ajaxStop")}if(p.complete){p.complete(g,r)}jQuery(v).unbind();setTimeout(function(){try{$(v).remove();$(b).remove()}catch(w){jQuery.handleError(p,g,null,w)}},100);g=null}};if(p.timeout>0){setTimeout(function(){if(!c){f("timeout")}},p.timeout)}try{var b=$("#"+o);$(b).attr("action",p.url);$(b).attr("method","POST");$(b).attr("target",j);if(b.encoding){b.encoding="multipart/form-data"}else{b.enctype="multipart/form-data"}$(b).submit()}catch(h){jQuery.handleError(p,g,null,h)}if(window.attachEvent){document.getElementById(j).attachEvent("onload",f)}else{document.getElementById(j).addEventListener("load",f,false)}return{abort:function(){}}},uploadHttpData:function(r,type){var data=!type;data=type=="xml"||data?r.responseXML:r.responseText;if(type=="script"){jQuery.globalEval(data)}if(type=="json"){eval("data = "+data)}if(type=="html"){jQuery("<div>").html(data).evalScripts()}return data}});